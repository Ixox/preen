/*
 * Copyright 2011 Xavier Hosxe
 *
 * Author: Xavier Hosxe (xavier.hosxe@gmail.com)
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */

#include "Osc.h"

short silence[1] = { 0 };
short realSquare[2] = {32000,-32000};
short noise[32];


const int frequenciesX8[]  = { 65,
// 1...
69, 73, 77, 82, 87, 92, 98, 103, 110, 116,
123, 130, 138, 146, 155, 164, 174, 184, 196, 207,
220, 233, 246, 261, 277, 293, 311, 329, 349, 370,
392, 415, 440, 466, 493, 523, 554, 587, 622, 659,
698, 740, 784, 830, 880, 932, 987, 1046, 1108, 1174,
1244, 1318, 1396, 1480, 1568, 1661, 1760, 1864, 1975, 2093,
2217, 2349, 2489, 2637, 2793, 2959, 3136, 3322, 3520, 3729,
3951, 4186, 4434, 4698, 4978, 5274, 5587, 5919, 6271, 6644,
7040, 7458, 7902, 8372, 8869, 9397, 9956, 10548, 11175, 11839,
12543, 13289, 14080, 14917, 15804, 16744, 17739, 18794, 19912, 21096,
22350, 23679, 25087, 26579, 28160, 29834, 31608, 33488, 35479, 37589,
39824, 42192, 44701, 47359, 50175, 53159, 56320, 59668, 63217, 66976,
70958, 75178, 79648, 84384, 89402, 94718 };





const short sinTable[] __FLASH__ = {
 // =================================================================
 // SIN : order 18 / 2048 steps
 //  m  =  2.0
 //  mul  =  32767.0
 //  max  =  1.0
 //  min  =  -1.0
0     , 100   , 201   , 301   , 402   , 502   , 603   , 703   , 804   , 904   ,
1005  , 1105  , 1206  , 1306  , 1406  , 1507  , 1607  , 1708  , 1808  , 1908  ,
2009  , 2109  , 2209  , 2310  , 2410  , 2510  , 2610  , 2711  , 2811  , 2911  ,
3011  , 3111  , 3211  , 3311  , 3411  , 3511  , 3611  , 3711  , 3811  , 3911  ,
4011  , 4110  , 4210  , 4310  , 4409  , 4509  , 4608  , 4708  , 4807  , 4907  ,
5006  , 5106  , 5205  , 5304  , 5403  , 5502  , 5601  , 5700  , 5799  , 5898  ,
5997  , 6096  , 6195  , 6293  , 6392  , 6491  , 6589  , 6688  , 6786  , 6884  ,
6982  , 7081  , 7179  , 7277  , 7375  , 7473  , 7571  , 7668  , 7766  , 7864  ,
7961  , 8059  , 8156  , 8253  , 8351  , 8448  , 8545  , 8642  , 8739  , 8836  ,
8932  , 9029  , 9126  , 9222  , 9319  , 9415  , 9511  , 9607  , 9703  , 9799  ,
9895  , 9991  , 10087 , 10182 , 10278 , 10373 , 10469 , 10564 , 10659 , 10754 ,
10849 , 10944 , 11038 , 11133 , 11227 , 11322 , 11416 , 11510 , 11604 , 11698 ,
11792 , 11886 , 11980 , 12073 , 12166 , 12260 , 12353 , 12446 , 12539 , 12632 ,
12724 , 12817 , 12909 , 13002 , 13094 , 13186 , 13278 , 13370 , 13462 , 13553 ,
13645 , 13736 , 13827 , 13918 , 14009 , 14100 , 14191 , 14281 , 14372 , 14462 ,
14552 , 14642 , 14732 , 14822 , 14911 , 15001 , 15090 , 15179 , 15268 , 15357 ,
15446 , 15534 , 15623 , 15711 , 15799 , 15887 , 15975 , 16063 , 16150 , 16238 ,
16325 , 16412 , 16499 , 16586 , 16672 , 16759 , 16845 , 16931 , 17017 , 17103 ,
17189 , 17274 , 17360 , 17445 , 17530 , 17615 , 17699 , 17784 , 17868 , 17952 ,
18036 , 18120 , 18204 , 18287 , 18371 , 18454 , 18537 , 18620 , 18702 , 18785 ,
18867 , 18949 , 19031 , 19113 , 19194 , 19276 , 19357 , 19438 , 19519 , 19599 ,
19680 , 19760 , 19840 , 19920 , 20000 , 20079 , 20159 , 20238 , 20317 , 20396 ,
20474 , 20553 , 20631 , 20709 , 20787 , 20864 , 20942 , 21019 , 21096 , 21173 ,
21249 , 21326 , 21402 , 21478 , 21554 , 21629 , 21705 , 21780 , 21855 , 21930 ,
22004 , 22079 , 22153 , 22227 , 22301 , 22374 , 22448 , 22521 , 22594 , 22666 ,
22739 , 22811 , 22883 , 22955 , 23027 , 23098 , 23169 , 23240 , 23311 , 23382 ,
23452 , 23522 , 23592 , 23661 , 23731 , 23800 , 23869 , 23938 , 24006 , 24075 ,
24143 , 24211 , 24278 , 24346 , 24413 , 24480 , 24546 , 24613 , 24679 , 24745 ,
24811 , 24877 , 24942 , 25007 , 25072 , 25136 , 25201 , 25265 , 25329 , 25392 ,
25456 , 25519 , 25582 , 25645 , 25707 , 25769 , 25831 , 25893 , 25954 , 26016 ,
26077 , 26137 , 26198 , 26258 , 26318 , 26378 , 26437 , 26497 , 26556 , 26615 ,
26673 , 26731 , 26789 , 26847 , 26905 , 26962 , 27019 , 27076 , 27132 , 27188 ,
27244 , 27300 , 27355 , 27411 , 27466 , 27520 , 27575 , 27629 , 27683 , 27736 ,
27790 , 27843 , 27896 , 27948 , 28001 , 28053 , 28105 , 28156 , 28208 , 28259 ,
28309 , 28360 , 28410 , 28460 , 28510 , 28559 , 28608 , 28657 , 28706 , 28754 ,
28802 , 28850 , 28897 , 28945 , 28992 , 29038 , 29085 , 29131 , 29177 , 29222 ,
29268 , 29313 , 29358 , 29402 , 29446 , 29490 , 29534 , 29577 , 29621 , 29663 ,
29706 , 29748 , 29790 , 29832 , 29873 , 29915 , 29955 , 29996 , 30036 , 30076 ,
30116 , 30156 , 30195 , 30234 , 30272 , 30311 , 30349 , 30386 , 30424 , 30461 ,
30498 , 30535 , 30571 , 30607 , 30643 , 30678 , 30713 , 30748 , 30783 , 30817 ,
30851 , 30885 , 30918 , 30951 , 30984 , 31017 , 31049 , 31081 , 31113 , 31144 ,
31175 , 31206 , 31236 , 31267 , 31297 , 31326 , 31356 , 31385 , 31413 , 31442 ,
31470 , 31498 , 31525 , 31553 , 31580 , 31606 , 31633 , 31659 , 31684 , 31710 ,
31735 , 31760 , 31785 , 31809 , 31833 , 31856 , 31880 , 31903 , 31926 , 31948 ,
31970 , 31992 , 32014 , 32035 , 32056 , 32077 , 32097 , 32117 , 32137 , 32156 ,
32176 , 32194 , 32213 , 32231 , 32249 , 32267 , 32284 , 32301 , 32318 , 32334 ,
32350 , 32366 , 32382 , 32397 , 32412 , 32426 , 32441 , 32455 , 32468 , 32482 ,
32495 , 32508 , 32520 , 32532 , 32544 , 32556 , 32567 , 32578 , 32588 , 32599 ,
32609 , 32618 , 32628 , 32637 , 32646 , 32654 , 32662 , 32670 , 32678 , 32685 ,
32692 , 32699 , 32705 , 32711 , 32717 , 32722 , 32727 , 32732 , 32736 , 32740 ,
32744 , 32748 , 32751 , 32754 , 32757 , 32759 , 32761 , 32763 , 32764 , 32765 ,
32766 , 32766 , 32767 , 32766 , 32766 , 32765 , 32764 , 32763 , 32761 , 32759 ,
32757 , 32754 , 32751 , 32748 , 32744 , 32740 , 32736 , 32732 , 32727 , 32722 ,
32717 , 32711 , 32705 , 32699 , 32692 , 32685 , 32678 , 32670 , 32662 , 32654 ,
32646 , 32637 , 32628 , 32618 , 32609 , 32599 , 32588 , 32578 , 32567 , 32556 ,
32544 , 32532 , 32520 , 32508 , 32495 , 32482 , 32468 , 32455 , 32441 , 32426 ,
32412 , 32397 , 32382 , 32366 , 32350 , 32334 , 32318 , 32301 , 32284 , 32267 ,
32249 , 32231 , 32213 , 32194 , 32176 , 32156 , 32137 , 32117 , 32097 , 32077 ,
32056 , 32035 , 32014 , 31992 , 31970 , 31948 , 31926 , 31903 , 31880 , 31856 ,
31833 , 31809 , 31785 , 31760 , 31735 , 31710 , 31684 , 31659 , 31633 , 31606 ,
31580 , 31553 , 31525 , 31498 , 31470 , 31442 , 31413 , 31385 , 31356 , 31326 ,
31297 , 31267 , 31236 , 31206 , 31175 , 31144 , 31113 , 31081 , 31049 , 31017 ,
30984 , 30951 , 30918 , 30885 , 30851 , 30817 , 30783 , 30748 , 30713 , 30678 ,
30643 , 30607 , 30571 , 30535 , 30498 , 30461 , 30424 , 30386 , 30349 , 30311 ,
30272 , 30234 , 30195 , 30156 , 30116 , 30076 , 30036 , 29996 , 29955 , 29915 ,
29873 , 29832 , 29790 , 29748 , 29706 , 29663 , 29621 , 29577 , 29534 , 29490 ,
29446 , 29402 , 29358 , 29313 , 29268 , 29222 , 29177 , 29131 , 29085 , 29038 ,
28992 , 28945 , 28897 , 28850 , 28802 , 28754 , 28706 , 28657 , 28608 , 28559 ,
28510 , 28460 , 28410 , 28360 , 28309 , 28259 , 28208 , 28156 , 28105 , 28053 ,
28001 , 27948 , 27896 , 27843 , 27790 , 27736 , 27683 , 27629 , 27575 , 27520 ,
27466 , 27411 , 27355 , 27300 , 27244 , 27188 , 27132 , 27076 , 27019 , 26962 ,
26905 , 26847 , 26789 , 26731 , 26673 , 26615 , 26556 , 26497 , 26437 , 26378 ,
26318 , 26258 , 26198 , 26137 , 26077 , 26016 , 25954 , 25893 , 25831 , 25769 ,
25707 , 25645 , 25582 , 25519 , 25456 , 25392 , 25329 , 25265 , 25201 , 25136 ,
25072 , 25007 , 24942 , 24877 , 24811 , 24745 , 24679 , 24613 , 24546 , 24480 ,
24413 , 24346 , 24278 , 24211 , 24143 , 24075 , 24006 , 23938 , 23869 , 23800 ,
23731 , 23661 , 23592 , 23522 , 23452 , 23382 , 23311 , 23240 , 23169 , 23098 ,
23027 , 22955 , 22883 , 22811 , 22739 , 22666 , 22594 , 22521 , 22448 , 22374 ,
22301 , 22227 , 22153 , 22079 , 22004 , 21930 , 21855 , 21780 , 21705 , 21629 ,
21554 , 21478 , 21402 , 21326 , 21249 , 21173 , 21096 , 21019 , 20942 , 20864 ,
20787 , 20709 , 20631 , 20553 , 20474 , 20396 , 20317 , 20238 , 20159 , 20079 ,
20000 , 19920 , 19840 , 19760 , 19680 , 19599 , 19519 , 19438 , 19357 , 19276 ,
19194 , 19113 , 19031 , 18949 , 18867 , 18785 , 18702 , 18620 , 18537 , 18454 ,
18371 , 18287 , 18204 , 18120 , 18036 , 17952 , 17868 , 17784 , 17699 , 17615 ,
17530 , 17445 , 17360 , 17274 , 17189 , 17103 , 17017 , 16931 , 16845 , 16759 ,
16672 , 16586 , 16499 , 16412 , 16325 , 16238 , 16150 , 16063 , 15975 , 15887 ,
15799 , 15711 , 15623 , 15534 , 15446 , 15357 , 15268 , 15179 , 15090 , 15001 ,
14911 , 14822 , 14732 , 14642 , 14552 , 14462 , 14372 , 14281 , 14191 , 14100 ,
14009 , 13918 , 13827 , 13736 , 13645 , 13553 , 13462 , 13370 , 13278 , 13186 ,
13094 , 13002 , 12909 , 12817 , 12724 , 12632 , 12539 , 12446 , 12353 , 12260 ,
12166 , 12073 , 11980 , 11886 , 11792 , 11698 , 11604 , 11510 , 11416 , 11322 ,
11227 , 11133 , 11038 , 10944 , 10849 , 10754 , 10659 , 10564 , 10469 , 10373 ,
10278 , 10182 , 10087 , 9991  , 9895  , 9799  , 9703  , 9607  , 9511  , 9415  ,
9319  , 9222  , 9126  , 9029  , 8932  , 8836  , 8739  , 8642  , 8545  , 8448  ,
8351  , 8253  , 8156  , 8059  , 7961  , 7864  , 7766  , 7668  , 7571  , 7473  ,
7375  , 7277  , 7179  , 7081  , 6982  , 6884  , 6786  , 6688  , 6589  , 6491  ,
6392  , 6293  , 6195  , 6096  , 5997  , 5898  , 5799  , 5700  , 5601  , 5502  ,
5403  , 5304  , 5205  , 5106  , 5006  , 4907  , 4807  , 4708  , 4608  , 4509  ,
4409  , 4310  , 4210  , 4110  , 4011  , 3911  , 3811  , 3711  , 3611  , 3511  ,
3411  , 3311  , 3211  , 3111  , 3011  , 2911  , 2811  , 2711  , 2610  , 2510  ,
2410  , 2310  , 2209  , 2109  , 2009  , 1908  , 1808  , 1708  , 1607  , 1507  ,
1406  , 1306  , 1206  , 1105  , 1005  , 904   , 804   , 703   , 603   , 502   ,
402   , 301   , 201   , 100   , 0     , -101  , -202  , -302  , -403  , -503  ,
-604  , -704  , -805  , -905  , -1006 , -1106 , -1207 , -1307 , -1407 , -1508 ,
-1608 , -1709 , -1809 , -1909 , -2010 , -2110 , -2210 , -2311 , -2411 , -2511 ,
-2611 , -2712 , -2812 , -2912 , -3012 , -3112 , -3212 , -3312 , -3412 , -3512 ,
-3612 , -3712 , -3812 , -3912 , -4012 , -4111 , -4211 , -4311 , -4410 , -4510 ,
-4609 , -4709 , -4808 , -4908 , -5007 , -5107 , -5206 , -5305 , -5404 , -5503 ,
-5602 , -5701 , -5800 , -5899 , -5998 , -6097 , -6196 , -6294 , -6393 , -6492 ,
-6590 , -6689 , -6787 , -6885 , -6983 , -7082 , -7180 , -7278 , -7376 , -7474 ,
-7572 , -7669 , -7767 , -7865 , -7962 , -8060 , -8157 , -8254 , -8352 , -8449 ,
-8546 , -8643 , -8740 , -8837 , -8933 , -9030 , -9127 , -9223 , -9320 , -9416 ,
-9512 , -9608 , -9704 , -9800 , -9896 , -9992 , -10088, -10183, -10279, -10374,
-10470, -10565, -10660, -10755, -10850, -10945, -11039, -11134, -11228, -11323,
-11417, -11511, -11605, -11699, -11793, -11887, -11981, -12074, -12167, -12261,
-12354, -12447, -12540, -12633, -12725, -12818, -12910, -13003, -13095, -13187,
-13279, -13371, -13463, -13554, -13646, -13737, -13828, -13919, -14010, -14101,
-14192, -14282, -14373, -14463, -14553, -14643, -14733, -14823, -14912, -15002,
-15091, -15180, -15269, -15358, -15447, -15535, -15624, -15712, -15800, -15888,
-15976, -16064, -16151, -16239, -16326, -16413, -16500, -16587, -16673, -16760,
-16846, -16932, -17018, -17104, -17190, -17275, -17361, -17446, -17531, -17616,
-17700, -17785, -17869, -17953, -18037, -18121, -18205, -18288, -18372, -18455,
-18538, -18621, -18703, -18786, -18868, -18950, -19032, -19114, -19195, -19277,
-19358, -19439, -19520, -19600, -19681, -19761, -19841, -19921, -20001, -20080,
-20160, -20239, -20318, -20397, -20475, -20554, -20632, -20710, -20788, -20865,
-20943, -21020, -21097, -21174, -21250, -21327, -21403, -21479, -21555, -21630,
-21706, -21781, -21856, -21931, -22005, -22080, -22154, -22228, -22302, -22375,
-22449, -22522, -22595, -22667, -22740, -22812, -22884, -22956, -23028, -23099,
-23170, -23241, -23312, -23383, -23453, -23523, -23593, -23662, -23732, -23801,
-23870, -23939, -24007, -24076, -24144, -24212, -24279, -24347, -24414, -24481,
-24547, -24614, -24680, -24746, -24812, -24878, -24943, -25008, -25073, -25137,
-25202, -25266, -25330, -25393, -25457, -25520, -25583, -25646, -25708, -25770,
-25832, -25894, -25955, -26017, -26078, -26138, -26199, -26259, -26319, -26379,
-26438, -26498, -26557, -26616, -26674, -26732, -26790, -26848, -26906, -26963,
-27020, -27077, -27133, -27189, -27245, -27301, -27356, -27412, -27467, -27521,
-27576, -27630, -27684, -27737, -27791, -27844, -27897, -27949, -28002, -28054,
-28106, -28157, -28209, -28260, -28310, -28361, -28411, -28461, -28511, -28560,
-28609, -28658, -28707, -28755, -28803, -28851, -28898, -28946, -28993, -29039,
-29086, -29132, -29178, -29223, -29269, -29314, -29359, -29403, -29447, -29491,
-29535, -29578, -29622, -29664, -29707, -29749, -29791, -29833, -29874, -29916,
-29956, -29997, -30037, -30077, -30117, -30157, -30196, -30235, -30273, -30312,
-30350, -30387, -30425, -30462, -30499, -30536, -30572, -30608, -30644, -30679,
-30714, -30749, -30784, -30818, -30852, -30886, -30919, -30952, -30985, -31018,
-31050, -31082, -31114, -31145, -31176, -31207, -31237, -31268, -31298, -31327,
-31357, -31386, -31414, -31443, -31471, -31499, -31526, -31554, -31581, -31607,
-31634, -31660, -31685, -31711, -31736, -31761, -31786, -31810, -31834, -31857,
-31881, -31904, -31927, -31949, -31971, -31993, -32015, -32036, -32057, -32078,
-32098, -32118, -32138, -32157, -32177, -32195, -32214, -32232, -32250, -32268,
-32285, -32302, -32319, -32335, -32351, -32367, -32383, -32398, -32413, -32427,
-32442, -32456, -32469, -32483, -32496, -32509, -32521, -32533, -32545, -32557,
-32568, -32579, -32589, -32600, -32610, -32619, -32629, -32638, -32647, -32655,
-32663, -32671, -32679, -32686, -32693, -32700, -32706, -32712, -32718, -32723,
-32728, -32733, -32737, -32741, -32745, -32749, -32752, -32755, -32758, -32760,
-32762, -32764, -32765, -32766, -32767, -32767, -32767, -32767, -32767, -32766,
-32765, -32764, -32762, -32760, -32758, -32755, -32752, -32749, -32745, -32741,
-32737, -32733, -32728, -32723, -32718, -32712, -32706, -32700, -32693, -32686,
-32679, -32671, -32663, -32655, -32647, -32638, -32629, -32619, -32610, -32600,
-32589, -32579, -32568, -32557, -32545, -32533, -32521, -32509, -32496, -32483,
-32469, -32456, -32442, -32427, -32413, -32398, -32383, -32367, -32351, -32335,
-32319, -32302, -32285, -32268, -32250, -32232, -32214, -32195, -32177, -32157,
-32138, -32118, -32098, -32078, -32057, -32036, -32015, -31993, -31971, -31949,
-31927, -31904, -31881, -31857, -31834, -31810, -31786, -31761, -31736, -31711,
-31685, -31660, -31634, -31607, -31581, -31554, -31526, -31499, -31471, -31443,
-31414, -31386, -31357, -31327, -31298, -31268, -31237, -31207, -31176, -31145,
-31114, -31082, -31050, -31018, -30985, -30952, -30919, -30886, -30852, -30818,
-30784, -30749, -30714, -30679, -30644, -30608, -30572, -30536, -30499, -30462,
-30425, -30387, -30350, -30312, -30273, -30235, -30196, -30157, -30117, -30077,
-30037, -29997, -29956, -29916, -29874, -29833, -29791, -29749, -29707, -29664,
-29622, -29578, -29535, -29491, -29447, -29403, -29359, -29314, -29269, -29223,
-29178, -29132, -29086, -29039, -28993, -28946, -28898, -28851, -28803, -28755,
-28707, -28658, -28609, -28560, -28511, -28461, -28411, -28361, -28310, -28260,
-28209, -28157, -28106, -28054, -28002, -27949, -27897, -27844, -27791, -27737,
-27684, -27630, -27576, -27521, -27467, -27412, -27356, -27301, -27245, -27189,
-27133, -27077, -27020, -26963, -26906, -26848, -26790, -26732, -26674, -26616,
-26557, -26498, -26438, -26379, -26319, -26259, -26199, -26138, -26078, -26017,
-25955, -25894, -25832, -25770, -25708, -25646, -25583, -25520, -25457, -25393,
-25330, -25266, -25202, -25137, -25073, -25008, -24943, -24878, -24812, -24746,
-24680, -24614, -24547, -24481, -24414, -24347, -24279, -24212, -24144, -24076,
-24007, -23939, -23870, -23801, -23732, -23662, -23593, -23523, -23453, -23383,
-23312, -23241, -23170, -23099, -23028, -22956, -22884, -22812, -22740, -22667,
-22595, -22522, -22449, -22375, -22302, -22228, -22154, -22080, -22005, -21931,
-21856, -21781, -21706, -21630, -21555, -21479, -21403, -21327, -21250, -21174,
-21097, -21020, -20943, -20865, -20788, -20710, -20632, -20554, -20475, -20397,
-20318, -20239, -20160, -20080, -20001, -19921, -19841, -19761, -19681, -19600,
-19520, -19439, -19358, -19277, -19195, -19114, -19032, -18950, -18868, -18786,
-18703, -18621, -18538, -18455, -18372, -18288, -18205, -18121, -18037, -17953,
-17869, -17785, -17700, -17616, -17531, -17446, -17361, -17275, -17190, -17104,
-17018, -16932, -16846, -16760, -16673, -16587, -16500, -16413, -16326, -16239,
-16151, -16064, -15976, -15888, -15800, -15712, -15624, -15535, -15447, -15358,
-15269, -15180, -15091, -15002, -14912, -14823, -14733, -14643, -14553, -14463,
-14373, -14282, -14192, -14101, -14010, -13919, -13828, -13737, -13646, -13554,
-13463, -13371, -13279, -13187, -13095, -13003, -12910, -12818, -12725, -12633,
-12540, -12447, -12354, -12261, -12167, -12074, -11981, -11887, -11793, -11699,
-11605, -11511, -11417, -11323, -11228, -11134, -11039, -10945, -10850, -10755,
-10660, -10565, -10470, -10374, -10279, -10183, -10088, -9992 , -9896 , -9800 ,
-9704 , -9608 , -9512 , -9416 , -9320 , -9223 , -9127 , -9030 , -8933 , -8837 ,
-8740 , -8643 , -8546 , -8449 , -8352 , -8254 , -8157 , -8060 , -7962 , -7865 ,
-7767 , -7669 , -7572 , -7474 , -7376 , -7278 , -7180 , -7082 , -6983 , -6885 ,
-6787 , -6689 , -6590 , -6492 , -6393 , -6294 , -6196 , -6097 , -5998 , -5899 ,
-5800 , -5701 , -5602 , -5503 , -5404 , -5305 , -5206 , -5107 , -5007 , -4908 ,
-4808 , -4709 , -4609 , -4510 , -4410 , -4311 , -4211 , -4111 , -4012 , -3912 ,
-3812 , -3712 , -3612 , -3512 , -3412 , -3312 , -3212 , -3112 , -3012 , -2912 ,
-2812 , -2712 , -2611 , -2511 , -2411 , -2311 , -2210 , -2110 , -2010 , -1909 ,
-1809 , -1709 , -1608 , -1508 , -1407 , -1307 , -1207 , -1106 , -1006 , -905  ,
-805  , -704  , -604  , -503  , -403  , -302  , -202  , -101  ,
 // Min =  -32767 // Max =  32767

};

const short squareTable[] __FLASH__ = {
 // =================================================================
 // SQUARE : order 18 / 2048 steps
 //  m  =  2.3600123156036306
 //  mul  =  27768.499158547012
 //  max  =  1.1800061578018148
 //  min  =  -1.1800061578018155
0     , 976   , 1951  , 2924  , 3894  , 4860  , 5821  , 6777  , 7725  , 8666  ,
9598  , 10521 , 11433 , 12334 , 13222 , 14098 , 14959 , 15806 , 16638 , 17453 ,
18252 , 19033 , 19796 , 20541 , 21266 , 21971 , 22656 , 23319 , 23962 , 24583 ,
25182 , 25759 , 26313 , 26844 , 27352 , 27837 , 28299 , 28737 , 29152 , 29543 ,
29910 , 30254 , 30575 , 30873 , 31148 , 31400 , 31629 , 31836 , 32021 , 32184 ,
32327 , 32448 , 32549 , 32631 , 32692 , 32735 , 32760 , 32767 , 32756 , 32729 ,
32686 , 32628 , 32555 , 32468 , 32368 , 32256 , 32132 , 31996 , 31850 , 31695 ,
31530 , 31358 , 31178 , 30991 , 30799 , 30601 , 30399 , 30193 , 29984 , 29772 ,
29559 , 29345 , 29131 , 28917 , 28704 , 28493 , 28284 , 28078 , 27875 , 27675 ,
27481 , 27291 , 27106 , 26928 , 26755 , 26589 , 26430 , 26279 , 26135 , 25998 ,
25870 , 25751 , 25640 , 25538 , 25444 , 25360 , 25285 , 25218 , 25162 , 25114 ,
25075 , 25046 , 25026 , 25014 , 25012 , 25018 , 25033 , 25056 , 25088 , 25127 ,
25174 , 25228 , 25290 , 25358 , 25433 , 25515 , 25602 , 25694 , 25792 , 25895 ,
26002 , 26112 , 26227 , 26345 , 26466 , 26589 , 26714 , 26841 , 26969 , 27097 ,
27227 , 27356 , 27485 , 27613 , 27740 , 27865 , 27989 , 28110 , 28229 , 28345 ,
28457 , 28567 , 28672 , 28773 , 28871 , 28963 , 29051 , 29134 , 29211 , 29283 ,
29350 , 29411 , 29466 , 29516 , 29559 , 29597 , 29628 , 29654 , 29673 , 29686 ,
29693 , 29694 , 29689 , 29678 , 29661 , 29639 , 29611 , 29578 , 29539 , 29496 ,
29447 , 29394 , 29336 , 29274 , 29208 , 29138 , 29064 , 28988 , 28908 , 28825 ,
28740 , 28652 , 28563 , 28472 , 28380 , 28286 , 28192 , 28098 , 28003 , 27908 ,
27814 , 27720 , 27627 , 27536 , 27446 , 27357 , 27271 , 27187 , 27105 , 27026 ,
26950 , 26878 , 26808 , 26742 , 26680 , 26621 , 26567 , 26516 , 26470 , 26428 ,
26391 , 26358 , 26329 , 26306 , 26287 , 26272 , 26263 , 26258 , 26258 , 26262 ,
26271 , 26284 , 26302 , 26325 , 26351 , 26382 , 26417 , 26456 , 26498 , 26544 ,
26594 , 26647 , 26703 , 26762 , 26823 , 26887 , 26953 , 27022 , 27092 , 27164 ,
27237 , 27312 , 27387 , 27463 , 27540 , 27616 , 27693 , 27770 , 27846 , 27921 ,
27996 , 28069 , 28141 , 28211 , 28280 , 28347 , 28411 , 28473 , 28533 , 28590 ,
28644 , 28695 , 28743 , 28788 , 28830 , 28868 , 28902 , 28933 , 28960 , 28983 ,
29002 , 29018 , 29029 , 29037 , 29041 , 29040 , 29036 , 29028 , 29016 , 29001 ,
28982 , 28959 , 28932 , 28902 , 28869 , 28833 , 28793 , 28751 , 28706 , 28658 ,
28607 , 28555 , 28500 , 28443 , 28384 , 28324 , 28262 , 28199 , 28135 , 28070 ,
28005 , 27939 , 27872 , 27806 , 27740 , 27674 , 27609 , 27545 , 27481 , 27419 ,
27358 , 27299 , 27241 , 27185 , 27131 , 27079 , 27030 , 26983 , 26938 , 26896 ,
26858 , 26822 , 26789 , 26759 , 26732 , 26709 , 26689 , 26672 , 26659 , 26649 ,
26643 , 26640 , 26640 , 26644 , 26652 , 26663 , 26677 , 26694 , 26715 , 26739 ,
26766 , 26796 , 26828 , 26864 , 26902 , 26943 , 26986 , 27031 , 27079 , 27128 ,
27179 , 27232 , 27287 , 27342 , 27399 , 27457 , 27515 , 27575 , 27634 , 27694 ,
27754 , 27813 , 27873 , 27932 , 27990 , 28048 , 28104 , 28159 , 28213 , 28265 ,
28316 , 28365 , 28412 , 28457 , 28500 , 28540 , 28578 , 28613 , 28646 , 28676 ,
28703 , 28727 , 28748 , 28766 , 28781 , 28793 , 28801 , 28807 , 28809 , 28808 ,
28804 , 28797 , 28787 , 28773 , 28757 , 28737 , 28715 , 28689 , 28661 , 28631 ,
28598 , 28562 , 28524 , 28483 , 28441 , 28397 , 28350 , 28302 , 28253 , 28202 ,
28150 , 28097 , 28043 , 27988 , 27932 , 27876 , 27820 , 27764 , 27708 , 27652 ,
27597 , 27542 , 27488 , 27435 , 27383 , 27333 , 27284 , 27236 , 27190 , 27146 ,
27103 , 27063 , 27025 , 26990 , 26957 , 26926 , 26898 , 26873 , 26850 , 26830 ,
26813 , 26800 , 26789 , 26781 , 26776 , 26774 , 26775 , 26779 , 26787 , 26797 ,
26810 , 26826 , 26845 , 26867 , 26891 , 26919 , 26948 , 26980 , 27015 , 27052 ,
27091 , 27132 , 27175 , 27220 , 27266 , 27314 , 27363 , 27414 , 27465 , 27518 ,
27571 , 27625 , 27679 , 27733 , 27787 , 27842 , 27896 , 27950 , 28003 , 28055 ,
28107 , 28157 , 28206 , 28254 , 28300 , 28345 , 28388 , 28429 , 28468 , 28505 ,
28539 , 28571 , 28601 , 28628 , 28653 , 28675 , 28694 , 28710 , 28723 , 28734 ,
28741 , 28746 , 28747 , 28746 , 28741 , 28734 , 28723 , 28710 , 28694 , 28675 ,
28653 , 28628 , 28601 , 28571 , 28539 , 28505 , 28468 , 28429 , 28388 , 28345 ,
28300 , 28254 , 28206 , 28157 , 28107 , 28055 , 28003 , 27950 , 27896 , 27842 ,
27787 , 27733 , 27679 , 27625 , 27571 , 27518 , 27465 , 27414 , 27363 , 27314 ,
27266 , 27220 , 27175 , 27132 , 27091 , 27052 , 27015 , 26980 , 26948 , 26919 ,
26891 , 26867 , 26845 , 26826 , 26810 , 26797 , 26787 , 26779 , 26775 , 26774 ,
26776 , 26781 , 26789 , 26800 , 26813 , 26830 , 26850 , 26873 , 26898 , 26926 ,
26957 , 26990 , 27025 , 27063 , 27103 , 27146 , 27190 , 27236 , 27284 , 27333 ,
27383 , 27435 , 27488 , 27542 , 27597 , 27652 , 27708 , 27764 , 27820 , 27876 ,
27932 , 27988 , 28043 , 28097 , 28150 , 28202 , 28253 , 28302 , 28350 , 28397 ,
28441 , 28483 , 28524 , 28562 , 28598 , 28631 , 28661 , 28689 , 28715 , 28737 ,
28757 , 28773 , 28787 , 28797 , 28804 , 28808 , 28809 , 28807 , 28801 , 28793 ,
28781 , 28766 , 28748 , 28727 , 28703 , 28676 , 28646 , 28613 , 28578 , 28540 ,
28500 , 28457 , 28412 , 28365 , 28316 , 28265 , 28213 , 28159 , 28104 , 28048 ,
27990 , 27932 , 27873 , 27813 , 27754 , 27694 , 27634 , 27575 , 27515 , 27457 ,
27399 , 27342 , 27287 , 27232 , 27179 , 27128 , 27079 , 27031 , 26986 , 26943 ,
26902 , 26864 , 26828 , 26796 , 26766 , 26739 , 26715 , 26694 , 26677 , 26663 ,
26652 , 26644 , 26640 , 26640 , 26643 , 26649 , 26659 , 26672 , 26689 , 26709 ,
26732 , 26759 , 26789 , 26822 , 26858 , 26896 , 26938 , 26983 , 27030 , 27079 ,
27131 , 27185 , 27241 , 27299 , 27358 , 27419 , 27481 , 27545 , 27609 , 27674 ,
27740 , 27806 , 27872 , 27939 , 28005 , 28070 , 28135 , 28199 , 28262 , 28324 ,
28384 , 28443 , 28500 , 28555 , 28607 , 28658 , 28706 , 28751 , 28793 , 28833 ,
28869 , 28902 , 28932 , 28959 , 28982 , 29001 , 29016 , 29028 , 29036 , 29040 ,
29041 , 29037 , 29029 , 29018 , 29002 , 28983 , 28960 , 28933 , 28902 , 28868 ,
28830 , 28788 , 28743 , 28695 , 28644 , 28590 , 28533 , 28473 , 28411 , 28347 ,
28280 , 28211 , 28141 , 28069 , 27996 , 27921 , 27846 , 27770 , 27693 , 27616 ,
27540 , 27463 , 27387 , 27312 , 27237 , 27164 , 27092 , 27022 , 26953 , 26887 ,
26823 , 26762 , 26703 , 26647 , 26594 , 26544 , 26498 , 26456 , 26417 , 26382 ,
26351 , 26325 , 26302 , 26284 , 26271 , 26262 , 26258 , 26258 , 26263 , 26272 ,
26287 , 26306 , 26329 , 26358 , 26391 , 26428 , 26470 , 26516 , 26567 , 26621 ,
26680 , 26742 , 26808 , 26878 , 26950 , 27026 , 27105 , 27187 , 27271 , 27357 ,
27446 , 27536 , 27627 , 27720 , 27814 , 27908 , 28003 , 28098 , 28192 , 28286 ,
28380 , 28472 , 28563 , 28652 , 28740 , 28825 , 28908 , 28988 , 29064 , 29138 ,
29208 , 29274 , 29336 , 29394 , 29447 , 29496 , 29539 , 29578 , 29611 , 29639 ,
29661 , 29678 , 29689 , 29694 , 29693 , 29686 , 29673 , 29654 , 29628 , 29597 ,
29559 , 29516 , 29466 , 29411 , 29350 , 29283 , 29211 , 29134 , 29051 , 28963 ,
28871 , 28773 , 28672 , 28567 , 28457 , 28345 , 28229 , 28110 , 27989 , 27865 ,
27740 , 27613 , 27485 , 27356 , 27227 , 27097 , 26969 , 26841 , 26714 , 26589 ,
26466 , 26345 , 26227 , 26112 , 26002 , 25895 , 25792 , 25694 , 25602 , 25515 ,
25433 , 25358 , 25290 , 25228 , 25174 , 25127 , 25088 , 25056 , 25033 , 25018 ,
25012 , 25014 , 25026 , 25046 , 25075 , 25114 , 25162 , 25218 , 25285 , 25360 ,
25444 , 25538 , 25640 , 25751 , 25870 , 25998 , 26135 , 26279 , 26430 , 26589 ,
26755 , 26928 , 27106 , 27291 , 27481 , 27675 , 27875 , 28078 , 28284 , 28493 ,
28704 , 28917 , 29131 , 29345 , 29559 , 29772 , 29984 , 30193 , 30399 , 30601 ,
30799 , 30991 , 31178 , 31358 , 31530 , 31695 , 31850 , 31996 , 32132 , 32256 ,
32368 , 32468 , 32555 , 32628 , 32686 , 32729 , 32756 , 32767 , 32760 , 32735 ,
32692 , 32631 , 32549 , 32448 , 32327 , 32184 , 32021 , 31836 , 31629 , 31400 ,
31148 , 30873 , 30575 , 30254 , 29910 , 29543 , 29152 , 28737 , 28299 , 27837 ,
27352 , 26844 , 26313 , 25759 , 25182 , 24583 , 23962 , 23319 , 22656 , 21971 ,
21266 , 20541 , 19796 , 19033 , 18252 , 17453 , 16638 , 15806 , 14959 , 14098 ,
13222 , 12334 , 11433 , 10521 , 9598  , 8666  , 7725  , 6777  , 5821  , 4860  ,
3894  , 2924  , 1951  , 976   , 0     , -977  , -1952 , -2925 , -3895 , -4861 ,
-5822 , -6778 , -7726 , -8667 , -9599 , -10522, -11434, -12335, -13223, -14099,
-14960, -15807, -16639, -17454, -18253, -19034, -19797, -20542, -21267, -21972,
-22657, -23320, -23963, -24584, -25183, -25760, -26314, -26845, -27353, -27838,
-28300, -28738, -29153, -29544, -29911, -30255, -30576, -30874, -31149, -31401,
-31630, -31837, -32022, -32185, -32328, -32449, -32550, -32632, -32693, -32736,
-32761, -32767, -32757, -32730, -32687, -32629, -32556, -32469, -32369, -32257,
-32133, -31997, -31851, -31696, -31531, -31359, -31179, -30992, -30800, -30602,
-30400, -30194, -29985, -29773, -29560, -29346, -29132, -28918, -28705, -28494,
-28285, -28079, -27876, -27676, -27482, -27292, -27107, -26929, -26756, -26590,
-26431, -26280, -26136, -25999, -25871, -25752, -25641, -25539, -25445, -25361,
-25286, -25219, -25163, -25115, -25076, -25047, -25027, -25015, -25013, -25019,
-25034, -25057, -25089, -25128, -25175, -25229, -25291, -25359, -25434, -25516,
-25603, -25695, -25793, -25896, -26003, -26113, -26228, -26346, -26467, -26590,
-26715, -26842, -26970, -27098, -27228, -27357, -27486, -27614, -27741, -27866,
-27990, -28111, -28230, -28346, -28458, -28568, -28673, -28774, -28872, -28964,
-29052, -29135, -29212, -29284, -29351, -29412, -29467, -29517, -29560, -29598,
-29629, -29655, -29674, -29687, -29694, -29695, -29690, -29679, -29662, -29640,
-29612, -29579, -29540, -29497, -29448, -29395, -29337, -29275, -29209, -29139,
-29065, -28989, -28909, -28826, -28741, -28653, -28564, -28473, -28381, -28287,
-28193, -28099, -28004, -27909, -27815, -27721, -27628, -27537, -27447, -27358,
-27272, -27188, -27106, -27027, -26951, -26879, -26809, -26743, -26681, -26622,
-26568, -26517, -26471, -26429, -26392, -26359, -26330, -26307, -26288, -26273,
-26264, -26259, -26259, -26263, -26272, -26285, -26303, -26326, -26352, -26383,
-26418, -26457, -26499, -26545, -26595, -26648, -26704, -26763, -26824, -26888,
-26954, -27023, -27093, -27165, -27238, -27313, -27388, -27464, -27541, -27617,
-27694, -27771, -27847, -27922, -27997, -28070, -28142, -28212, -28281, -28348,
-28412, -28474, -28534, -28591, -28645, -28696, -28744, -28789, -28831, -28869,
-28903, -28934, -28961, -28984, -29003, -29019, -29030, -29038, -29042, -29041,
-29037, -29029, -29017, -29002, -28983, -28960, -28933, -28903, -28870, -28834,
-28794, -28752, -28707, -28659, -28608, -28556, -28501, -28444, -28385, -28325,
-28263, -28200, -28136, -28071, -28006, -27940, -27873, -27807, -27741, -27675,
-27610, -27546, -27482, -27420, -27359, -27300, -27242, -27186, -27132, -27080,
-27031, -26984, -26939, -26897, -26859, -26823, -26790, -26760, -26733, -26710,
-26690, -26673, -26660, -26650, -26644, -26641, -26641, -26645, -26653, -26664,
-26678, -26695, -26716, -26740, -26767, -26797, -26829, -26865, -26903, -26944,
-26987, -27032, -27080, -27129, -27180, -27233, -27288, -27343, -27400, -27458,
-27516, -27576, -27635, -27695, -27755, -27814, -27874, -27933, -27991, -28049,
-28105, -28160, -28214, -28266, -28317, -28366, -28413, -28458, -28501, -28541,
-28579, -28614, -28647, -28677, -28704, -28728, -28749, -28767, -28782, -28794,
-28802, -28808, -28810, -28809, -28805, -28798, -28788, -28774, -28758, -28738,
-28716, -28690, -28662, -28632, -28599, -28563, -28525, -28484, -28442, -28398,
-28351, -28303, -28254, -28203, -28151, -28098, -28044, -27989, -27933, -27877,
-27821, -27765, -27709, -27653, -27598, -27543, -27489, -27436, -27384, -27334,
-27285, -27237, -27191, -27147, -27104, -27064, -27026, -26991, -26958, -26927,
-26899, -26874, -26851, -26831, -26814, -26801, -26790, -26782, -26777, -26775,
-26776, -26780, -26788, -26798, -26811, -26827, -26846, -26868, -26892, -26920,
-26949, -26981, -27016, -27053, -27092, -27133, -27176, -27221, -27267, -27315,
-27364, -27415, -27466, -27519, -27572, -27626, -27680, -27734, -27788, -27843,
-27897, -27951, -28004, -28056, -28108, -28158, -28207, -28255, -28301, -28346,
-28389, -28430, -28469, -28506, -28540, -28572, -28602, -28629, -28654, -28676,
-28695, -28711, -28724, -28735, -28742, -28747, -28748, -28747, -28742, -28735,
-28724, -28711, -28695, -28676, -28654, -28629, -28602, -28572, -28540, -28506,
-28469, -28430, -28389, -28346, -28301, -28255, -28207, -28158, -28108, -28056,
-28004, -27951, -27897, -27843, -27788, -27734, -27680, -27626, -27572, -27519,
-27466, -27415, -27364, -27315, -27267, -27221, -27176, -27133, -27092, -27053,
-27016, -26981, -26949, -26920, -26892, -26868, -26846, -26827, -26811, -26798,
-26788, -26780, -26776, -26775, -26777, -26782, -26790, -26801, -26814, -26831,
-26851, -26874, -26899, -26927, -26958, -26991, -27026, -27064, -27104, -27147,
-27191, -27237, -27285, -27334, -27384, -27436, -27489, -27543, -27598, -27653,
-27709, -27765, -27821, -27877, -27933, -27989, -28044, -28098, -28151, -28203,
-28254, -28303, -28351, -28398, -28442, -28484, -28525, -28563, -28599, -28632,
-28662, -28690, -28716, -28738, -28758, -28774, -28788, -28798, -28805, -28809,
-28810, -28808, -28802, -28794, -28782, -28767, -28749, -28728, -28704, -28677,
-28647, -28614, -28579, -28541, -28501, -28458, -28413, -28366, -28317, -28266,
-28214, -28160, -28105, -28049, -27991, -27933, -27874, -27814, -27755, -27695,
-27635, -27576, -27516, -27458, -27400, -27343, -27288, -27233, -27180, -27129,
-27080, -27032, -26987, -26944, -26903, -26865, -26829, -26797, -26767, -26740,
-26716, -26695, -26678, -26664, -26653, -26645, -26641, -26641, -26644, -26650,
-26660, -26673, -26690, -26710, -26733, -26760, -26790, -26823, -26859, -26897,
-26939, -26984, -27031, -27080, -27132, -27186, -27242, -27300, -27359, -27420,
-27482, -27546, -27610, -27675, -27741, -27807, -27873, -27940, -28006, -28071,
-28136, -28200, -28263, -28325, -28385, -28444, -28501, -28556, -28608, -28659,
-28707, -28752, -28794, -28834, -28870, -28903, -28933, -28960, -28983, -29002,
-29017, -29029, -29037, -29041, -29042, -29038, -29030, -29019, -29003, -28984,
-28961, -28934, -28903, -28869, -28831, -28789, -28744, -28696, -28645, -28591,
-28534, -28474, -28412, -28348, -28281, -28212, -28142, -28070, -27997, -27922,
-27847, -27771, -27694, -27617, -27541, -27464, -27388, -27313, -27238, -27165,
-27093, -27023, -26954, -26888, -26824, -26763, -26704, -26648, -26595, -26545,
-26499, -26457, -26418, -26383, -26352, -26326, -26303, -26285, -26272, -26263,
-26259, -26259, -26264, -26273, -26288, -26307, -26330, -26359, -26392, -26429,
-26471, -26517, -26568, -26622, -26681, -26743, -26809, -26879, -26951, -27027,
-27106, -27188, -27272, -27358, -27447, -27537, -27628, -27721, -27815, -27909,
-28004, -28099, -28193, -28287, -28381, -28473, -28564, -28653, -28741, -28826,
-28909, -28989, -29065, -29139, -29209, -29275, -29337, -29395, -29448, -29497,
-29540, -29579, -29612, -29640, -29662, -29679, -29690, -29695, -29694, -29687,
-29674, -29655, -29629, -29598, -29560, -29517, -29467, -29412, -29351, -29284,
-29212, -29135, -29052, -28964, -28872, -28774, -28673, -28568, -28458, -28346,
-28230, -28111, -27990, -27866, -27741, -27614, -27486, -27357, -27228, -27098,
-26970, -26842, -26715, -26590, -26467, -26346, -26228, -26113, -26003, -25896,
-25793, -25695, -25603, -25516, -25434, -25359, -25291, -25229, -25175, -25128,
-25089, -25057, -25034, -25019, -25013, -25015, -25027, -25047, -25076, -25115,
-25163, -25219, -25286, -25361, -25445, -25539, -25641, -25752, -25871, -25999,
-26136, -26280, -26431, -26590, -26756, -26929, -27107, -27292, -27482, -27676,
-27876, -28079, -28285, -28494, -28705, -28918, -29132, -29346, -29560, -29773,
-29985, -30194, -30400, -30602, -30800, -30992, -31179, -31359, -31531, -31696,
-31851, -31997, -32133, -32257, -32369, -32469, -32556, -32629, -32687, -32730,
-32757, -32767, -32761, -32736, -32693, -32632, -32550, -32449, -32328, -32185,
-32022, -31837, -31630, -31401, -31149, -30874, -30576, -30255, -29911, -29544,
-29153, -28738, -28300, -27838, -27353, -26845, -26314, -25760, -25183, -24584,
-23963, -23320, -22657, -21972, -21267, -20542, -19797, -19034, -18253, -17454,
-16639, -15807, -14960, -14099, -13223, -12335, -11434, -10522, -9599 , -8667 ,
-7726 , -6778 , -5822 , -4861 , -3895 , -2925 , -1952 , -977  ,
 // Min =  -32767 // Max =  32767

};

const short sawTable[] __FLASH__ = {
 // =================================================================
 // SAWTOOTH : order 18 / 2048 steps
 //  m  =  1.1258826008351095
 //  mul  =  58206.779242694545
 //  max  =  0.5629413004175547
 //  min  =  -0.5629413004175546
-1    , -1023 , -2045 , -3065 , -4081 , -5093 , -6099 , -7098 , -8090 , -9073 ,
-10046, -11008, -11958, -12895, -13818, -14727, -15620, -16496, -17354, -18195,
-19016, -19818, -20599, -21359, -22097, -22812, -23505, -24175, -24820, -25441,
-26038, -26609, -27155, -27676, -28171, -28640, -29083, -29500, -29891, -30256,
-30595, -30909, -31196, -31459, -31696, -31908, -32096, -32260, -32400, -32516,
-32610, -32681, -32731, -32760, -32767, -32756, -32724, -32675, -32607, -32522,
-32421, -32304, -32173, -32027, -31868, -31697, -31514, -31321, -31118, -30905,
-30685, -30457, -30222, -29982, -29737, -29488, -29236, -28982, -28725, -28468,
-28211, -27954, -27698, -27445, -27194, -26947, -26703, -26464, -26230, -26002,
-25779, -25564, -25355, -25154, -24961, -24776, -24600, -24432, -24274, -24125,
-23986, -23856, -23736, -23626, -23526, -23437, -23357, -23287, -23227, -23178,
-23138, -23107, -23086, -23075, -23072, -23079, -23094, -23117, -23148, -23187,
-23233, -23286, -23346, -23412, -23484, -23561, -23643, -23730, -23821, -23915,
-24013, -24113, -24216, -24321, -24427, -24534, -24641, -24749, -24856, -24962,
-25067, -25171, -25272, -25371, -25467, -25561, -25650, -25736, -25818, -25895,
-25967, -26035, -26097, -26154, -26205, -26251, -26290, -26323, -26350, -26371,
-26385, -26393, -26394, -26389, -26377, -26358, -26334, -26302, -26265, -26221,
-26171, -26115, -26054, -25986, -25914, -25836, -25753, -25665, -25572, -25476,
-25375, -25271, -25163, -25052, -24938, -24821, -24702, -24582, -24459, -24336,
-24211, -24085, -23960, -23834, -23708, -23583, -23459, -23336, -23215, -23095,
-22977, -22862, -22749, -22639, -22532, -22428, -22327, -22231, -22138, -22049,
-21964, -21884, -21808, -21737, -21670, -21608, -21551, -21498, -21451, -21408,
-21370, -21338, -21310, -21286, -21268, -21254, -21245, -21241, -21240, -21244,
-21252, -21265, -21280, -21300, -21323, -21349, -21378, -21410, -21445, -21482,
-21522, -21563, -21606, -21650, -21696, -21742, -21789, -21837, -21885, -21933,
-21981, -22028, -22074, -22120, -22164, -22207, -22248, -22287, -22324, -22359,
-22391, -22421, -22448, -22472, -22493, -22511, -22525, -22536, -22543, -22547,
-22547, -22543, -22535, -22524, -22508, -22489, -22465, -22438, -22406, -22371,
-22332, -22289, -22243, -22193, -22139, -22082, -22022, -21958, -21892, -21822,
-21750, -21675, -21598, -21519, -21437, -21354, -21268, -21182, -21094, -21005,
-20915, -20824, -20733, -20641, -20550, -20458, -20367, -20276, -20186, -20097,
-20009, -19922, -19837, -19753, -19671, -19591, -19514, -19438, -19365, -19294,
-19226, -19161, -19098, -19039, -18982, -18929, -18879, -18832, -18788, -18748,
-18711, -18677, -18647, -18620, -18596, -18575, -18558, -18544, -18532, -18524,
-18519, -18517, -18517, -18520, -18526, -18534, -18544, -18557, -18571, -18588,
-18606, -18625, -18646, -18668, -18691, -18715, -18740, -18765, -18791, -18817,
-18843, -18868, -18894, -18918, -18942, -18966, -18988, -19009, -19029, -19047,
-19064, -19079, -19092, -19103, -19112, -19118, -19123, -19124, -19124, -19121,
-19115, -19106, -19095, -19081, -19064, -19044, -19021, -18995, -18967, -18935,
-18901, -18864, -18824, -18782, -18736, -18689, -18638, -18585, -18530, -18473,
-18413, -18351, -18288, -18222, -18155, -18087, -18017, -17945, -17873, -17799,
-17725, -17650, -17574, -17498, -17422, -17346, -17270, -17194, -17118, -17043,
-16969, -16895, -16823, -16751, -16681, -16612, -16545, -16479, -16415, -16353,
-16293, -16235, -16179, -16125, -16073, -16024, -15977, -15932, -15890, -15851,
-15814, -15780, -15748, -15719, -15692, -15668, -15646, -15627, -15610, -15596,
-15584, -15575, -15567, -15562, -15559, -15558, -15559, -15561, -15565, -15571,
-15578, -15587, -15596, -15607, -15619, -15632, -15645, -15659, -15673, -15687,
-15702, -15716, -15731, -15745, -15759, -15772, -15785, -15796, -15807, -15817,
-15825, -15832, -15838, -15842, -15845, -15846, -15845, -15843, -15838, -15831,
-15823, -15812, -15799, -15783, -15766, -15746, -15724, -15699, -15672, -15643,
-15611, -15578, -15541, -15503, -15462, -15420, -15375, -15328, -15279, -15228,
-15176, -15121, -15065, -15008, -14949, -14888, -14826, -14764, -14700, -14635,
-14569, -14503, -14436, -14369, -14301, -14234, -14166, -14098, -14031, -13963,
-13897, -13830, -13765, -13700, -13637, -13574, -13512, -13452, -13393, -13336,
-13280, -13225, -13173, -13122, -13073, -13025, -12980, -12937, -12896, -12857,
-12820, -12785, -12752, -12721, -12693, -12667, -12642, -12620, -12600, -12582,
-12567, -12553, -12541, -12530, -12522, -12515, -12510, -12507, -12505, -12505,
-12505, -12507, -12510, -12515, -12520, -12525, -12532, -12539, -12546, -12554,
-12562, -12570, -12578, -12586, -12594, -12601, -12608, -12614, -12620, -12625,
-12628, -12631, -12633, -12633, -12632, -12630, -12626, -12621, -12614, -12606,
-12595, -12583, -12569, -12553, -12536, -12516, -12494, -12471, -12445, -12417,
-12388, -12356, -12322, -12287, -12249, -12209, -12168, -12125, -12080, -12034,
-11985, -11935, -11884, -11831, -11777, -11722, -11665, -11608, -11549, -11490,
-11429, -11369, -11307, -11245, -11183, -11120, -11057, -10995, -10932, -10870,
-10808, -10746, -10685, -10624, -10564, -10505, -10447, -10390, -10334, -10279,
-10226, -10173, -10123, -10073, -10026, -9980 , -9935 , -9893 , -9852 , -9813 ,
-9775 , -9740 , -9706 , -9675 , -9645 , -9617 , -9591 , -9567 , -9545 , -9524 ,
-9506 , -9489 , -9474 , -9460 , -9448 , -9438 , -9430 , -9422 , -9416 , -9412 ,
-9409 , -9406 , -9405 , -9405 , -9406 , -9407 , -9410 , -9412 , -9416 , -9419 ,
-9423 , -9427 , -9431 , -9435 , -9439 , -9443 , -9446 , -9449 , -9452 , -9453 ,
-9454 , -9454 , -9454 , -9452 , -9449 , -9445 , -9439 , -9433 , -9425 , -9415 ,
-9404 , -9391 , -9377 , -9361 , -9343 , -9324 , -9303 , -9280 , -9255 , -9229 ,
-9201 , -9170 , -9139 , -9105 , -9069 , -9032 , -8993 , -8953 , -8911 , -8867 ,
-8822 , -8775 , -8727 , -8677 , -8626 , -8574 , -8521 , -8467 , -8412 , -8356 ,
-8299 , -8241 , -8183 , -8125 , -8066 , -8007 , -7947 , -7887 , -7828 , -7768 ,
-7709 , -7650 , -7591 , -7533 , -7476 , -7419 , -7363 , -7308 , -7253 , -7200 ,
-7148 , -7097 , -7047 , -6999 , -6952 , -6906 , -6862 , -6819 , -6778 , -6739 ,
-6701 , -6665 , -6631 , -6598 , -6567 , -6538 , -6511 , -6485 , -6461 , -6439 ,
-6418 , -6399 , -6382 , -6366 , -6352 , -6340 , -6328 , -6319 , -6310 , -6303 ,
-6297 , -6292 , -6288 , -6285 , -6283 , -6282 , -6281 , -6281 , -6282 , -6283 ,
-6284 , -6285 , -6287 , -6289 , -6290 , -6292 , -6293 , -6294 , -6295 , -6295 ,
-6294 , -6293 , -6290 , -6287 , -6283 , -6278 , -6272 , -6265 , -6256 , -6246 ,
-6235 , -6222 , -6208 , -6192 , -6175 , -6156 , -6136 , -6114 , -6090 , -6065 ,
-6037 , -6009 , -5978 , -5946 , -5912 , -5877 , -5840 , -5801 , -5761 , -5719 ,
-5676 , -5631 , -5585 , -5538 , -5489 , -5439 , -5388 , -5337 , -5284 , -5230 ,
-5175 , -5120 , -5064 , -5008 , -4951 , -4893 , -4836 , -4778 , -4720 , -4663 ,
-4605 , -4548 , -4490 , -4434 , -4377 , -4322 , -4267 , -4212 , -4159 , -4106 ,
-4055 , -4004 , -3955 , -3907 , -3860 , -3814 , -3770 , -3727 , -3685 , -3646 ,
-3607 , -3570 , -3535 , -3502 , -3470 , -3440 , -3411 , -3384 , -3359 , -3335 ,
-3313 , -3292 , -3273 , -3256 , -3240 , -3226 , -3213 , -3201 , -3191 , -3182 ,
-3174 , -3167 , -3161 , -3156 , -3153 , -3150 , -3147 , -3146 , -3144 , -3144 ,
-3144 , -3144 , -3144 , -3144 , -3145 , -3145 , -3145 , -3145 , -3145 , -3144 ,
-3142 , -3140 , -3138 , -3134 , -3130 , -3125 , -3118 , -3111 , -3102 , -3093 ,
-3082 , -3069 , -3056 , -3040 , -3024 , -3006 , -2986 , -2965 , -2942 , -2918 ,
-2892 , -2864 , -2835 , -2804 , -2771 , -2737 , -2701 , -2664 , -2625 , -2585 ,
-2543 , -2500 , -2456 , -2410 , -2363 , -2315 , -2265 , -2215 , -2163 , -2111 ,
-2058 , -2004 , -1949 , -1894 , -1838 , -1782 , -1725 , -1669 , -1612 , -1555 ,
-1498 , -1441 , -1385 , -1328 , -1272 , -1217 , -1162 , -1108 , -1055 , -1002 ,
-951  , -900  , -850  , -802  , -754  , -708  , -663  , -620  , -578  , -537  ,
-498  , -460  , -424  , -390  , -357  , -325  , -296  , -267  , -241  , -216  ,
-193  , -171  , -151  , -132  , -115  , -99   , -85   , -72   , -60   , -50   ,
-41   , -33   , -26   , -20   , -16   , -11   , -8    , -6    , -4    , -2    ,
-1    , -1    , -1    , -1    , -1    , 0     , 0     , 0     , 0     , 1     ,
3     , 5     , 7     , 10    , 15    , 19    , 25    , 32    , 40    , 49    ,
59    , 71    , 84    , 98    , 114   , 131   , 150   , 170   , 192   , 215   ,
240   , 266   , 295   , 324   , 356   , 389   , 423   , 459   , 497   , 536   ,
577   , 619   , 662   , 707   , 753   , 801   , 849   , 899   , 950   , 1001  ,
1054  , 1107  , 1161  , 1216  , 1271  , 1327  , 1384  , 1440  , 1497  , 1554  ,
1611  , 1668  , 1724  , 1781  , 1837  , 1893  , 1948  , 2003  , 2057  , 2110  ,
2162  , 2214  , 2264  , 2314  , 2362  , 2409  , 2455  , 2499  , 2542  , 2584  ,
2624  , 2663  , 2700  , 2736  , 2770  , 2803  , 2834  , 2863  , 2891  , 2917  ,
2941  , 2964  , 2985  , 3005  , 3023  , 3039  , 3055  , 3068  , 3081  , 3092  ,
3101  , 3110  , 3117  , 3124  , 3129  , 3133  , 3137  , 3139  , 3141  , 3143  ,
3144  , 3144  , 3144  , 3144  , 3144  , 3143  , 3143  , 3143  , 3143  , 3143  ,
3143  , 3145  , 3146  , 3149  , 3152  , 3155  , 3160  , 3166  , 3173  , 3181  ,
3190  , 3200  , 3212  , 3225  , 3239  , 3255  , 3272  , 3291  , 3312  , 3334  ,
3358  , 3383  , 3410  , 3439  , 3469  , 3501  , 3534  , 3569  , 3606  , 3645  ,
3684  , 3726  , 3769  , 3813  , 3859  , 3906  , 3954  , 4003  , 4054  , 4105  ,
4158  , 4211  , 4266  , 4321  , 4376  , 4433  , 4489  , 4547  , 4604  , 4662  ,
4719  , 4777  , 4835  , 4892  , 4950  , 5007  , 5063  , 5119  , 5174  , 5229  ,
5283  , 5336  , 5387  , 5438  , 5488  , 5537  , 5584  , 5630  , 5675  , 5718  ,
5760  , 5800  , 5839  , 5876  , 5911  , 5945  , 5977  , 6008  , 6036  , 6064  ,
6089  , 6113  , 6135  , 6155  , 6174  , 6191  , 6207  , 6221  , 6234  , 6245  ,
6255  , 6264  , 6271  , 6277  , 6282  , 6286  , 6289  , 6292  , 6293  , 6294  ,
6294  , 6293  , 6292  , 6291  , 6289  , 6288  , 6286  , 6284  , 6283  , 6282  ,
6281  , 6280  , 6280  , 6281  , 6282  , 6284  , 6287  , 6291  , 6296  , 6302  ,
6309  , 6318  , 6327  , 6339  , 6351  , 6365  , 6381  , 6398  , 6417  , 6438  ,
6460  , 6484  , 6510  , 6537  , 6566  , 6597  , 6630  , 6664  , 6700  , 6738  ,
6777  , 6818  , 6861  , 6905  , 6951  , 6998  , 7046  , 7096  , 7147  , 7199  ,
7252  , 7307  , 7362  , 7418  , 7475  , 7532  , 7590  , 7649  , 7708  , 7767  ,
7827  , 7886  , 7946  , 8006  , 8065  , 8124  , 8182  , 8240  , 8298  , 8355  ,
8411  , 8466  , 8520  , 8573  , 8625  , 8676  , 8726  , 8774  , 8821  , 8866  ,
8910  , 8952  , 8992  , 9031  , 9068  , 9104  , 9138  , 9169  , 9200  , 9228  ,
9254  , 9279  , 9302  , 9323  , 9342  , 9360  , 9376  , 9390  , 9403  , 9414  ,
9424  , 9432  , 9438  , 9444  , 9448  , 9451  , 9453  , 9453  , 9453  , 9452  ,
9451  , 9448  , 9445  , 9442  , 9438  , 9434  , 9430  , 9426  , 9422  , 9418  ,
9415  , 9411  , 9409  , 9406  , 9405  , 9404  , 9404  , 9405  , 9408  , 9411  ,
9415  , 9421  , 9429  , 9437  , 9447  , 9459  , 9473  , 9488  , 9505  , 9523  ,
9544  , 9566  , 9590  , 9616  , 9644  , 9674  , 9705  , 9739  , 9774  , 9812  ,
9851  , 9892  , 9934  , 9979  , 10025 , 10072 , 10122 , 10172 , 10225 , 10278 ,
10333 , 10389 , 10446 , 10504 , 10563 , 10623 , 10684 , 10745 , 10807 , 10869 ,
10931 , 10994 , 11056 , 11119 , 11182 , 11244 , 11306 , 11368 , 11428 , 11489 ,
11548 , 11607 , 11664 , 11721 , 11776 , 11830 , 11883 , 11934 , 11984 , 12033 ,
12079 , 12124 , 12167 , 12208 , 12248 , 12286 , 12321 , 12355 , 12387 , 12416 ,
12444 , 12470 , 12493 , 12515 , 12535 , 12552 , 12568 , 12582 , 12594 , 12605 ,
12613 , 12620 , 12625 , 12629 , 12631 , 12632 , 12632 , 12630 , 12627 , 12624 ,
12619 , 12613 , 12607 , 12600 , 12593 , 12585 , 12577 , 12569 , 12561 , 12553 ,
12545 , 12538 , 12531 , 12524 , 12519 , 12514 , 12509 , 12506 , 12504 , 12504 ,
12504 , 12506 , 12509 , 12514 , 12521 , 12529 , 12540 , 12552 , 12566 , 12581 ,
12599 , 12619 , 12641 , 12666 , 12692 , 12720 , 12751 , 12784 , 12819 , 12856 ,
12895 , 12936 , 12979 , 13024 , 13072 , 13121 , 13172 , 13224 , 13279 , 13335 ,
13392 , 13451 , 13511 , 13573 , 13636 , 13699 , 13764 , 13829 , 13896 , 13962 ,
14030 , 14097 , 14165 , 14233 , 14300 , 14368 , 14435 , 14502 , 14568 , 14634 ,
14699 , 14763 , 14825 , 14887 , 14948 , 15007 , 15064 , 15120 , 15175 , 15227 ,
15278 , 15327 , 15374 , 15419 , 15461 , 15502 , 15540 , 15577 , 15610 , 15642 ,
15671 , 15698 , 15723 , 15745 , 15765 , 15782 , 15798 , 15811 , 15822 , 15830 ,
15837 , 15842 , 15844 , 15845 , 15844 , 15841 , 15837 , 15831 , 15824 , 15816 ,
15806 , 15795 , 15784 , 15771 , 15758 , 15744 , 15730 , 15715 , 15701 , 15686 ,
15672 , 15658 , 15644 , 15631 , 15618 , 15606 , 15595 , 15586 , 15577 , 15570 ,
15564 , 15560 , 15558 , 15557 , 15558 , 15561 , 15566 , 15574 , 15583 , 15595 ,
15609 , 15626 , 15645 , 15667 , 15691 , 15718 , 15747 , 15779 , 15813 , 15850 ,
15889 , 15931 , 15976 , 16023 , 16072 , 16124 , 16178 , 16234 , 16292 , 16352 ,
16414 , 16478 , 16544 , 16611 , 16680 , 16750 , 16822 , 16894 , 16968 , 17042 ,
17117 , 17193 , 17269 , 17345 , 17421 , 17497 , 17573 , 17649 , 17724 , 17798 ,
17872 , 17944 , 18016 , 18086 , 18154 , 18221 , 18287 , 18350 , 18412 , 18472 ,
18529 , 18584 , 18637 , 18688 , 18735 , 18781 , 18823 , 18863 , 18900 , 18934 ,
18966 , 18994 , 19020 , 19043 , 19063 , 19080 , 19094 , 19105 , 19114 , 19120 ,
19123 , 19123 , 19122 , 19117 , 19111 , 19102 , 19091 , 19078 , 19063 , 19046 ,
19028 , 19008 , 18987 , 18965 , 18941 , 18917 , 18893 , 18867 , 18842 , 18816 ,
18790 , 18764 , 18739 , 18714 , 18690 , 18667 , 18645 , 18624 , 18605 , 18587 ,
18570 , 18556 , 18543 , 18533 , 18525 , 18519 , 18516 , 18516 , 18518 , 18523 ,
18531 , 18543 , 18557 , 18574 , 18595 , 18619 , 18646 , 18676 , 18710 , 18747 ,
18787 , 18831 , 18878 , 18928 , 18981 , 19038 , 19097 , 19160 , 19225 , 19293 ,
19364 , 19437 , 19513 , 19590 , 19670 , 19752 , 19836 , 19921 , 20008 , 20096 ,
20185 , 20275 , 20366 , 20457 , 20549 , 20640 , 20732 , 20823 , 20914 , 21004 ,
21093 , 21181 , 21267 , 21353 , 21436 , 21518 , 21597 , 21674 , 21749 , 21821 ,
21891 , 21957 , 22021 , 22081 , 22138 , 22192 , 22242 , 22288 , 22331 , 22370 ,
22405 , 22437 , 22464 , 22488 , 22507 , 22523 , 22534 , 22542 , 22546 , 22546 ,
22542 , 22535 , 22524 , 22510 , 22492 , 22471 , 22447 , 22420 , 22390 , 22358 ,
22323 , 22286 , 22247 , 22206 , 22163 , 22119 , 22073 , 22027 , 21980 , 21932 ,
21884 , 21836 , 21788 , 21741 , 21695 , 21649 , 21605 , 21562 , 21521 , 21481 ,
21444 , 21409 , 21377 , 21348 , 21322 , 21299 , 21279 , 21264 , 21251 , 21243 ,
21239 , 21240 , 21244 , 21253 , 21267 , 21285 , 21309 , 21337 , 21369 , 21407 ,
21450 , 21497 , 21550 , 21607 , 21669 , 21736 , 21807 , 21883 , 21963 , 22048 ,
22137 , 22230 , 22326 , 22427 , 22531 , 22638 , 22748 , 22861 , 22976 , 23094 ,
23214 , 23335 , 23458 , 23582 , 23707 , 23833 , 23959 , 24084 , 24210 , 24335 ,
24458 , 24581 , 24701 , 24820 , 24937 , 25051 , 25162 , 25270 , 25374 , 25475 ,
25571 , 25664 , 25752 , 25835 , 25913 , 25985 , 26053 , 26114 , 26170 , 26220 ,
26264 , 26301 , 26333 , 26357 , 26376 , 26388 , 26393 , 26392 , 26384 , 26370 ,
26349 , 26322 , 26289 , 26250 , 26204 , 26153 , 26096 , 26034 , 25966 , 25894 ,
25817 , 25735 , 25649 , 25560 , 25466 , 25370 , 25271 , 25170 , 25066 , 24961 ,
24855 , 24748 , 24640 , 24533 , 24426 , 24320 , 24215 , 24112 , 24012 , 23914 ,
23820 , 23729 , 23642 , 23560 , 23483 , 23411 , 23345 , 23285 , 23232 , 23186 ,
23147 , 23116 , 23093 , 23078 , 23071 , 23074 , 23085 , 23106 , 23137 , 23177 ,
23226 , 23286 , 23356 , 23436 , 23525 , 23625 , 23735 , 23855 , 23985 , 24124 ,
24273 , 24431 , 24599 , 24775 , 24960 , 25153 , 25354 , 25563 , 25778 , 26001 ,
26229 , 26463 , 26702 , 26946 , 27193 , 27444 , 27697 , 27953 , 28210 , 28467 ,
28724 , 28981 , 29235 , 29487 , 29736 , 29981 , 30221 , 30456 , 30684 , 30904 ,
31117 , 31320 , 31513 , 31696 , 31867 , 32026 , 32172 , 32303 , 32420 , 32521 ,
32606 , 32674 , 32723 , 32755 , 32767 , 32759 , 32730 , 32680 , 32609 , 32515 ,
32399 , 32259 , 32095 , 31907 , 31695 , 31458 , 31195 , 30908 , 30594 , 30255 ,
29890 , 29499 , 29082 , 28639 , 28170 , 27675 , 27154 , 26608 , 26037 , 25440 ,
24819 , 24174 , 23504 , 22811 , 22096 , 21358 , 20598 , 19817 , 19015 , 18194 ,
17353 , 16495 , 15619 , 14726 , 13817 , 12894 , 11957 , 11007 , 10045 , 9072  ,
8089  , 7097  , 6098  , 5092  , 4080  , 3064  , 2044  , 1022  ,
 // Min =  -32767 // Max =  32767
};


// This one is in flash to free some RAM...
// 2 other sinus variation are in RAM only.
const short int ssquTable [] = {
-32253, -32245, -32215, -32166, -32099, -32010, -31904, -31778, -31634, -31471
, -31288, -31085, -30865, -30626, -30368, -30093, -29799, -29486, -29158, -28809
, -28445, -28063, -27665, -27250, -26819, -26370, -25907, -25427, -24933, -24423
, -23899, -23362, -22806, -22241, -21661, -21068, -20462, -19844, -19214, -18572
, -17920, -17257, -16583, -15898, -15205, -14502, -13790, -13071, -12343, -11608
, -10866, -10120, -9364, -8604, -7838, -7068, -6293, -5515, -4733, -3948
, -3164, -2373, -1583, -794, -2, 791, 1582, 2370, 3159, 3947
, 4732, 5514, 6292, 7065, 7835, 8603, 9361, 10117, 10863, 11607
, 12342, 13070, 13791, 14501, 15204, 15895, 16582, 17256, 17917, 18571
, 19213, 19841, 20463, 21065, 21658, 22239, 22806, 23359, 23898, 24420
, 24932, 25426, 25906, 26367, 26818, 27249, 27666, 28060, 28446, 28810
, 29155, 29485, 29799, 30092, 30367, 30623, 30864, 31082, 31285, 31470
, 31633, 31779, 31905, 32011, 32098, 32165, 32216, 32244, 32256, 32244
, 32216, 32165, 32098, 32011, 31905, 31779, 31633, 31470, 31285, 31082
, 30864, 30623, 30367, 30092, 29799, 29485, 29155, 28810, 28446, 28060
, 27666, 27249, 26818, 26367, 25906, 25426, 24932, 24420, 23898, 23359
, 22806, 22239, 21658, 21065, 20463, 19841, 19213, 18571, 17917, 17256
, 16582, 15895, 15204, 14501, 13791, 13070, 12342, 11607, 10863, 10117
, 9361, 8603, 7835, 7065, 6292, 5514, 4732, 3947, 3159, 2370
, 1582, 791, -2, -794, -1583, -2373, -3164, -3948, -4733, -5515
, -6293, -7068, -7838, -8604, -9364, -10120, -10866, -11608, -12343, -13071
, -13790, -14502, -15205, -15898, -16583, -17257, -17920, -18572, -19214, -19844
, -20462, -21068, -21661, -22241, -22806, -23362, -23899, -24423, -24933, -25427
, -25907, -26370, -26819, -27250, -27665, -28063, -28445, -28809, -29158, -29486
, -29799, -30093, -30368, -30626, -30865, -31085, -31288, -31471, -31634, -31778
, -31904, -32010, -32099, -32166, -32215, -32245, -32253, -32245, -32215, -32166
, -32099, -32010, -31904, -31778, -31634, -31469, -31286, -31085, -30865, -30624
, -30368, -30093, -29798, -29486, -29156, -28809, -28445, -28063, -27663, -27248
, -26817, -26370, -25905, -25427, -24933, -24423, -23897, -23360, -22806, -22239
, -21659, -21066, -20462, -19842, -19212, -18570, -17918, -17255, -16581, -15896
, -15203, -14500, -13788, -13069, -12341, -11606, -10864, -10116, -9360, -8602
, -7834, -7066, -6291, -5513, -4731, -3946, -3160, -2371, -1579, -790
, 1, 793, 1584, 2374, 3163, 3949, 4734, 5518, 6296, 7069
, 7839, 8605, 9365, 10121, 10867, 11611, 12344, 13074, 13793, 14505
, 15208, 15899, 16586, 17260, 17921, 18575, 19216, 19845, 20467, 21069
, 21662, 22242, 22807, 23363, 23902, 24424, 24936, 25430, 25910, 26371
, 26822, 27253, 27668, 28064, 28450, 28814, 29159, 29489, 29802, 30096
, 30371, 30627, 30868, 31086, 31289, 31474, 31637, 31783, 31909, 32015
, 32102, 32169, 32220, 32248, 32256, 32248, 32220, 32169, 32102, 32015
, 31909, 31783, 31637, 31474, 31289, 31086, 30868, 30627, 30371, 30096
, 29802, 29489, 29159, 28814, 28450, 28064, 27668, 27253, 26822, 26371
, 25910, 25430, 24936, 24424, 23902, 23363, 22807, 22242, 21662, 21069
, 20467, 19845, 19216, 18575, 17921, 17260, 16586, 15899, 15208, 14505
, 13793, 13074, 12344, 11611, 10867, 10121, 9365, 8605, 7839, 7069
, 6296, 5518, 4734, 3949, 3163, 2374, 1584, 793, 1, -790
, -1579, -2371, -3160, -3946, -4731, -5513, -6291, -7066, -7834, -8602
, -9360, -10116, -10864, -11606, -12341, -13069, -13788, -14500, -15203, -15896
, -16581, -17255, -17918, -18570, -19212, -19842, -20462, -21066, -21659, -22239
, -22806, -23360, -23897, -24423, -24933, -25427, -25905, -26370, -26817, -27248
, -27663, -28063, -28445, -28809, -29156, -29486, -29798, -30093, -30368, -30624
, -30865, -31085, -31286, -31469, -31634, -31778, -31904, -32010, -32099, -32166
, -32215, -32245};


const short int szeroTable [] = {
-14992, -14414, -13836, -13259, -12682, -12104, -11528, -10951, -10376, -9801
, -9226, -8654, -8082, -7510, -6941, -6371, -5804, -5237, -4672, -4109
, -3548, -2988, -2430, -1874, -1320, -768, -218, 330, 875, 1418
, 1959, 2496, 3033, 3565, 4095, 4623, 5146, 5668, 6185, 6700
, 7211, 7719, 8223, 8725, 9223, 9717, 10207, 10693, 11176, 11655
, 12129, 12599, 13066, 13528, 13986, 14439, 14889, 15333, 15773, 16209
, 16639, 17066, 17487, 17902, 18313, 18720, 19121, 19516, 19907, 20293
, 20674, 21049, 21418, 21782, 22140, 22494, 22840, 23182, 23517, 23848
, 24171, 24490, 24802, 25108, 25409, 25702, 25991, 26273, 26547, 26818
, 27081, 27336, 27588, 27831, 28068, 28300, 28524, 28742, 28954, 29158
, 29356, 29547, 29733, 29910, 30082, 30246, 30404, 30554, 30699, 30835
, 30965, 31088, 31205, 31314, 31416, 31511, 31600, 31681, 31755, 31823
, 31883, 31936, 31982, 32021, 32053, 32077, 32096, 32106, 32110, 32106
, 32096, 32077, 32053, 32021, 31982, 31936, 31883, 31823, 31755, 31681
, 31600, 31511, 31416, 31314, 31205, 31088, 30965, 30835, 30699, 30554
, 30404, 30246, 30082, 29910, 29733, 29547, 29356, 29158, 28954, 28742
, 28524, 28300, 28068, 27831, 27588, 27336, 27081, 26818, 26547, 26273
, 25991, 25702, 25409, 25108, 24802, 24490, 24171, 23848, 23517, 23182
, 22840, 22494, 22140, 21782, 21418, 21049, 20674, 20293, 19907, 19516
, 19121, 18720, 18313, 17902, 17487, 17066, 16639, 16209, 15773, 15333
, 14889, 14439, 13986, 13528, 13066, 12599, 12129, 11655, 11176, 10693
, 10207, 9717, 9223, 8725, 8223, 7719, 7211, 6700, 6185, 5668
, 5146, 4623, 4095, 3565, 3033, 2496, 1959, 1418, 875, 330
, -218, -768, -1320, -1874, -2430, -2988, -3548, -4109, -4672, -5237
, -5804, -6371, -6941, -7510, -8082, -8654, -9226, -9801, -10376, -10951
, -11528, -12104, -12682, -13259, -13836, -14414, -14992, -14992, -14992, -14992
, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992
, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992
, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992
, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992
, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992
, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992
, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992
, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992
, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992
, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992
, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992
, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992
, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992
, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992
, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992
, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992
, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992
, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992
, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992
, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992
, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992
, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992
, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992
, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992
, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992, -14992
, -14992, -14992};


const short int sposTable [] = {
-32593, -31965, -31336, -30708, -30082, -29454, -28827, -28200, -27575, -26950
, -26325, -25704, -25082, -24460, -23841, -23222, -22605, -21990, -21375, -20763
, -20154, -19544, -18938, -18333, -17732, -17132, -16533, -15938, -15346, -14755
, -14168, -13583, -13000, -12422, -11846, -11272, -10704, -10136, -9574, -9015
, -8458, -7907, -7358, -6813, -6272, -5735, -5202, -4674, -4149, -3629
, -3113, -2602, -2094, -1593, -1094, -602, -113, 370, 848, 1321
, 1789, 2253, 2710, 3162, 3609, 4051, 4487, 4917, 5342, 5760
, 6175, 6582, 6984, 7379, 7768, 8153, 8529, 8901, 9265, 9625
, 9976, 10323, 10662, 10995, 11321, 11640, 11954, 12260, 12559, 12853
, 13139, 13417, 13690, 13954, 14212, 14464, 14707, 14945, 15175, 15396
, 15612, 15820, 16021, 16214, 16401, 16579, 16751, 16914, 17071, 17220
, 17360, 17495, 17621, 17740, 17851, 17954, 18051, 18139, 18220, 18293
, 18359, 18417, 18467, 18509, 18543, 18570, 18590, 18601, 18606, 18601
, 18590, 18570, 18543, 18509, 18467, 18417, 18359, 18293, 18220, 18139
, 18051, 17954, 17851, 17740, 17621, 17495, 17360, 17220, 17071, 16914
, 16751, 16579, 16401, 16214, 16021, 15820, 15612, 15396, 15175, 14945
, 14707, 14464, 14212, 13954, 13690, 13417, 13139, 12853, 12559, 12260
, 11954, 11640, 11321, 10995, 10662, 10323, 9976, 9625, 9265, 8901
, 8529, 8153, 7768, 7379, 6984, 6582, 6175, 5760, 5342, 4917
, 4487, 4051, 3609, 3162, 2710, 2253, 1789, 1321, 848, 370
, -113, -602, -1094, -1593, -2094, -2602, -3113, -3629, -4149, -4674
, -5202, -5735, -6272, -6813, -7358, -7907, -8458, -9015, -9574, -10136
, -10704, -11272, -11846, -12422, -13000, -13583, -14168, -14755, -15346, -15938
, -16533, -17132, -17732, -18333, -18938, -19544, -20154, -20763, -21375, -21990
, -22605, -23222, -23841, -24460, -25082, -25704, -26325, -26950, -27575, -28200
, -28827, -29454, -30082, -30708, -31336, -31965, -32593, -31963, -31335, -30707
, -30080, -29452, -28825, -28199, -27574, -26949, -26324, -25702, -25080, -24458
, -23840, -23221, -22604, -21988, -21374, -20761, -20152, -19543, -18936, -18332
, -17730, -17130, -16532, -15936, -15344, -14754, -14166, -13582, -12999, -12421
, -11844, -11271, -10702, -10135, -9572, -9013, -8457, -7905, -7357, -6811
, -6271, -5733, -5200, -4672, -4147, -3627, -3111, -2600, -2093, -1591
, -1093, -600, -111, 371, 850, 1323, 1790, 2254, 2712, 3164
, 3610, 4053, 4489, 4918, 5343, 5762, 6176, 6584, 6985, 7381
, 7770, 8154, 8531, 8903, 9267, 9626, 9978, 10325, 10664, 10996
, 11323, 11642, 11956, 12262, 12560, 12854, 13140, 13418, 13692, 13956
, 14214, 14465, 14709, 14946, 15176, 15398, 15614, 15821, 16023, 16215
, 16403, 16581, 16753, 16915, 17073, 17221, 17362, 17496, 17623, 17742
, 17853, 17956, 18053, 18140, 18221, 18295, 18360, 18418, 18468, 18510
, 18545, 18571, 18592, 18603, 18606, 18603, 18592, 18571, 18545, 18510
, 18468, 18418, 18360, 18295, 18221, 18140, 18053, 17956, 17853, 17742
, 17623, 17496, 17362, 17221, 17073, 16915, 16753, 16581, 16403, 16215
, 16023, 15821, 15614, 15398, 15176, 14946, 14709, 14465, 14214, 13956
, 13692, 13418, 13140, 12854, 12560, 12262, 11956, 11642, 11323, 10996
, 10664, 10325, 9978, 9626, 9267, 8903, 8531, 8154, 7770, 7381
, 6985, 6584, 6176, 5762, 5343, 4918, 4489, 4053, 3610, 3164
, 2712, 2254, 1790, 1323, 850, 371, -111, -600, -1093, -1591
, -2093, -2600, -3111, -3627, -4147, -4672, -5200, -5733, -6271, -6811
, -7357, -7905, -8457, -9013, -9572, -10135, -10702, -11271, -11844, -12421
, -12999, -13582, -14166, -14754, -15344, -15936, -16532, -17130, -17730, -18332
, -18936, -19543, -20152, -20761, -21374, -21988, -22604, -23221, -23840, -24458
, -25080, -25702, -26324, -26949, -27574, -28199, -28825, -29452, -30080, -30707
, -31335, -31963};




struct WaveTable waveTables[9] = {
//		OSC_SHAPE_SIN = 0,
		{
			sinTable,
			0x3ffff,
			7,
			1,0
		},
//		OSC_SHAPE_SIN2,
		{
			ssquTable,
			0x3ffff,
			9,
			1,0
		},
//		OSC_SHAPE_SIN3,
		{
			szeroTable,
			0x3ffff,
			9,
			1,0
		},
//		OSC_SHAPE_SIN4,
		{
			sposTable,
			0x3ffff,
			9,
			1,0
		},
//		OSC_SHAPE_RAND,
		{
			noise,
			0x1f,
			0,
			0,1
		},
//		OSC_SHAPE_SQUARE,
		{
			squareTable,
			0x3ffff,
			7,
			1,0
		},
//		OSC_SHAPE_SAW,
		{
			sawTable,
			0x3ffff,
			7,
			1,0
		},
		//	OSC_SHAPE_OFF,
		{
			silence,
			0x3ffff,
			32,
			0,0
		},
		//	OSC_SHAPE_SUARE 2,
		{
			realSquare,
			0x3ffff,
			17,
			1,0
		}
};


void Osc::init(int number, Matrix* matrix) {
    this->destFreq = (DestinationEnum)(OSC1_FREQ + number - 1);

    this->matrix = matrix;

    OscillatorParams * o = (OscillatorParams *)(&(this->synthState->params.osc1));
    oscillator = &o[number-1];
}

void Osc::newNote(struct OscState& oscState, int note) {
    oscState.index = 1; // << number;
    switch (oscillator->frequencyType) {
    case OSC_FT_KEYBOARD:
    	// frequency : 15 bits + oscillator 7 - 4 + 10 - 9
    	// MAX : 21 bits !
        oscState.mainFrequency = (((frequenciesX8[note] * oscillator->frequencyMul) >> 4) * (2048 + oscillator->detune)) >> 11;
        break;
    case OSC_FT_FIXE:
        oscState.mainFrequency = ((oscillator->frequencyMul << 7) + oscillator->detune)<<2;
        break;
    }
    oscState.frequency = oscState.mainFrequency;
}


void Osc::glideToNote(struct OscState& oscState, int note) {
    switch (oscillator->frequencyType) {
    case OSC_FT_KEYBOARD:
        oscState.nextFrequency = (((frequenciesX8[note] * oscillator->frequencyMul) >> 4) * (2048 + oscillator->detune)) >> 11;
        break;
    case OSC_FT_FIXE:
        oscState.nextFrequency = ((oscillator->frequencyMul << 7) + oscillator->detune)<<2;
        break;
    }
    oscState.fromFrequency = oscState.mainFrequency;
}


void Osc::glideStep(struct OscState& oscState, int step) {
    oscState.mainFrequency = ((oscState.fromFrequency * ((1<<this->synthState->params.engine1.glide) - step)) + oscState.nextFrequency * step) >> this->synthState->params.engine1.glide;
    oscState.frequency = oscState.mainFrequency;
}
