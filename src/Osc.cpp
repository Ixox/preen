/*
 * Copyright 2011 Xavier Hosxe
 *
 * Author: Xavier Hosxe (xavier.hosxe@gmail.com)
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */

#include "Osc.h"

int randomOsc;

const short sinTable[] __FLASH__ =  {
		0, 100, 201, 301, 402, 502, 603, 703, 804, 904 ,
		1005, 1105, 1206, 1306, 1406, 1507, 1607, 1708, 1808, 1908,
		2009, 2109, 2209, 2310, 2410, 2510, 2610, 2711, 2811, 2911,
		3011, 3111, 3211, 3311, 3411, 3511, 3611, 3711, 3811, 3911,
		4011, 4110, 4210, 4310, 4409, 4509, 4608, 4708, 4807, 4907,
		5006, 5106, 5205, 5304, 5403, 5502, 5601, 5700, 5799, 5898,
		5997, 6096, 6195, 6293, 6392, 6491, 6589, 6688, 6786, 6884,
		6982, 7081, 7179, 7277, 7375, 7473, 7571, 7668, 7766, 7864,
		7961, 8059, 8156, 8253, 8351, 8448, 8545, 8642, 8739, 8836,
		8932, 9029, 9126, 9222, 9319, 9415, 9511, 9607, 9703, 9799,
		9895, 9991, 10087, 10182, 10278, 10373, 10469, 10564, 10659, 10754,
		10849, 10944, 11038, 11133, 11227, 11322, 11416, 11510, 11604, 11698,
		11792, 11886, 11980, 12073, 12166, 12260, 12353, 12446, 12539, 12632,
		12724, 12817, 12909, 13002, 13094, 13186, 13278, 13370, 13462, 13553,
		13645, 13736, 13827, 13918, 14009, 14100, 14191, 14281, 14372, 14462,
		14552, 14642, 14732, 14822, 14911, 15001, 15090, 15179, 15268, 15357,
		15446, 15534, 15623, 15711, 15799, 15887, 15975, 16063, 16150, 16238,
		16325, 16412, 16499, 16586, 16672, 16759, 16845, 16931, 17017, 17103,
		17189, 17274, 17360, 17445, 17530, 17615, 17699, 17784, 17868, 17952,
		18036, 18120, 18204, 18287, 18371, 18454, 18537, 18620, 18702, 18785,
		18867, 18949, 19031, 19113, 19194, 19276, 19357, 19438, 19519, 19599,
		19680, 19760, 19840, 19920, 20000, 20079, 20159, 20238, 20317, 20396,
		20474, 20553, 20631, 20709, 20787, 20864, 20942, 21019, 21096, 21173,
		21249, 21326, 21402, 21478, 21554, 21629, 21705, 21780, 21855, 21930,
		22004, 22079, 22153, 22227, 22301, 22374, 22448, 22521, 22594, 22666,
		22739, 22811, 22883, 22955, 23027, 23098, 23169, 23240, 23311, 23382,
		23452, 23522, 23592, 23661, 23731, 23800, 23869, 23938, 24006, 24075,
		24143, 24211, 24278, 24346, 24413, 24480, 24546, 24613, 24679, 24745,
		24811, 24877, 24942, 25007, 25072, 25136, 25201, 25265, 25329, 25392,
		25456, 25519, 25582, 25645, 25707, 25769, 25831, 25893, 25954, 26016,
		26077, 26137, 26198, 26258, 26318, 26378, 26437, 26497, 26556, 26615,
		26673, 26731, 26789, 26847, 26905, 26962, 27019, 27076, 27132, 27188,
		27244, 27300, 27355, 27411, 27466, 27520, 27575, 27629, 27683, 27736,
		27790, 27843, 27896, 27948, 28001, 28053, 28105, 28156, 28208, 28259,
		28309, 28360, 28410, 28460, 28510, 28559, 28608, 28657, 28706, 28754,
		28802, 28850, 28897, 28945, 28992, 29038, 29085, 29131, 29177, 29222,
		29268, 29313, 29358, 29402, 29446, 29490, 29534, 29577, 29621, 29663,
		29706, 29748, 29790, 29832, 29873, 29915, 29955, 29996, 30036, 30076,
		30116, 30156, 30195, 30234, 30272, 30311, 30349, 30386, 30424, 30461,
		30498, 30535, 30571, 30607, 30643, 30678, 30713, 30748, 30783, 30817,
		30851, 30885, 30918, 30951, 30984, 31017, 31049, 31081, 31113, 31144,
		31175, 31206, 31236, 31267, 31297, 31326, 31356, 31385, 31413, 31442,
		31470, 31498, 31525, 31553, 31580, 31606, 31633, 31659, 31684, 31710,
		31735, 31760, 31785, 31809, 31833, 31856, 31880, 31903, 31926, 31948,
		31970, 31992, 32014, 32035, 32056, 32077, 32097, 32117, 32137, 32156,
		32176, 32194, 32213, 32231, 32249, 32267, 32284, 32301, 32318, 32334,
		32350, 32366, 32382, 32397, 32412, 32426, 32441, 32455, 32468, 32482,
		32495, 32508, 32520, 32532, 32544, 32556, 32567, 32578, 32588, 32599,
		32609, 32618, 32628, 32637, 32646, 32654, 32662, 32670, 32678, 32685,
		32692, 32699, 32705, 32711, 32717, 32722, 32727, 32732, 32736, 32740,
		32744, 32748, 32751, 32754, 32757, 32759, 32761, 32763, 32764, 32765,
		32766, 32766, 32767, 32766, 32766, 32765, 32764, 32763, 32761, 32759,
		32757, 32754, 32751, 32748, 32744, 32740, 32736, 32732, 32727, 32722,
		32717, 32711, 32705, 32699, 32692, 32685, 32678, 32670, 32662, 32654,
		32646, 32637, 32628, 32618, 32609, 32599, 32588, 32578, 32567, 32556,
		32544, 32532, 32520, 32508, 32495, 32482, 32468, 32455, 32441, 32426,
		32412, 32397, 32382, 32366, 32350, 32334, 32318, 32301, 32284, 32267,
		32249, 32231, 32213, 32194, 32176, 32156, 32137, 32117, 32097, 32077,
		32056, 32035, 32014, 31992, 31970, 31948, 31926, 31903, 31880, 31856,
		31833, 31809, 31785, 31760, 31735, 31710, 31684, 31659, 31633, 31606,
		31580, 31553, 31525, 31498, 31470, 31442, 31413, 31385, 31356, 31326,
		31297, 31267, 31236, 31206, 31175, 31144, 31113, 31081, 31049, 31017,
		30984, 30951, 30918, 30885, 30851, 30817, 30783, 30748, 30713, 30678,
		30643, 30607, 30571, 30535, 30498, 30461, 30424, 30386, 30349, 30311,
		30272, 30234, 30195, 30156, 30116, 30076, 30036, 29996, 29955, 29915,
		29873, 29832, 29790, 29748, 29706, 29663, 29621, 29577, 29534, 29490,
		29446, 29402, 29358, 29313, 29268, 29222, 29177, 29131, 29085, 29038,
		28992, 28945, 28897, 28850, 28802, 28754, 28706, 28657, 28608, 28559,
		28510, 28460, 28410, 28360, 28309, 28259, 28208, 28156, 28105, 28053,
		28001, 27948, 27896, 27843, 27790, 27736, 27683, 27629, 27575, 27520,
		27466, 27411, 27355, 27300, 27244, 27188, 27132, 27076, 27019, 26962,
		26905, 26847, 26789, 26731, 26673, 26615, 26556, 26497, 26437, 26378,
		26318, 26258, 26198, 26137, 26077, 26016, 25954, 25893, 25831, 25769,
		25707, 25645, 25582, 25519, 25456, 25392, 25329, 25265, 25201, 25136,
		25072, 25007, 24942, 24877, 24811, 24745, 24679, 24613, 24546, 24480,
		24413, 24346, 24278, 24211, 24143, 24075, 24006, 23938, 23869, 23800,
		23731, 23661, 23592, 23522, 23452, 23382, 23311, 23240, 23169, 23098,
		23027, 22955, 22883, 22811, 22739, 22666, 22594, 22521, 22448, 22374,
		22301, 22227, 22153, 22079, 22004, 21930, 21855, 21780, 21705, 21629,
		21554, 21478, 21402, 21326, 21249, 21173, 21096, 21019, 20942, 20864,
		20787, 20709, 20631, 20553, 20474, 20396, 20317, 20238, 20159, 20079,
		20000, 19920, 19840, 19760, 19680, 19599, 19519, 19438, 19357, 19276,
		19194, 19113, 19031, 18949, 18867, 18785, 18702, 18620, 18537, 18454,
		18371, 18287, 18204, 18120, 18036, 17952, 17868, 17784, 17699, 17615,
		17530, 17445, 17360, 17274, 17189, 17103, 17017, 16931, 16845, 16759,
		16672, 16586, 16499, 16412, 16325, 16238, 16150, 16063, 15975, 15887,
		15799, 15711, 15623, 15534, 15446, 15357, 15268, 15179, 15090, 15001,
		14911, 14822, 14732, 14642, 14552, 14462, 14372, 14281, 14191, 14100,
		14009, 13918, 13827, 13736, 13645, 13553, 13462, 13370, 13278, 13186,
		13094, 13002, 12909, 12817, 12724, 12632, 12539, 12446, 12353, 12260,
		12166, 12073, 11980, 11886, 11792, 11698, 11604, 11510, 11416, 11322,
		11227, 11133, 11038, 10944, 10849, 10754, 10659, 10564, 10469, 10373,
		10278, 10182, 10087, 9991, 9895, 9799, 9703, 9607, 9511, 9415,
		9319, 9222, 9126, 9029, 8932, 8836, 8739, 8642, 8545, 8448,
		8351, 8253, 8156, 8059, 7961, 7864, 7766, 7668, 7571, 7473,
		7375, 7277, 7179, 7081, 6982, 6884, 6786, 6688, 6589, 6491,
		6392, 6293, 6195, 6096, 5997, 5898, 5799, 5700, 5601, 5502,
		5403, 5304, 5205, 5106, 5006, 4907, 4807, 4708, 4608, 4509,
		4409, 4310, 4210, 4110, 4011, 3911, 3811, 3711, 3611, 3511,
		3411, 3311, 3211, 3111, 3011, 2911, 2811, 2711, 2610, 2510,
		2410, 2310, 2209, 2109, 2009, 1908, 1808, 1708, 1607, 1507,
		1406, 1306, 1206, 1105, 1005, 904, 804, 703, 603, 502,
		402, 301, 201, 100, 0, -100, -201, -301, -402, -502,
		-603, -703, -804, -904, -1005, -1105, -1206, -1306, -1406, -1507,
		-1607, -1708, -1808, -1908, -2009, -2109, -2209, -2310, -2410, -2510,
		-2610, -2711, -2811, -2911, -3011, -3111, -3211, -3311, -3411, -3511,
		-3611, -3711, -3811, -3911, -4011, -4110, -4210, -4310, -4409, -4509,
		-4608, -4708, -4807, -4907, -5006, -5106, -5205, -5304, -5403, -5502,
		-5601, -5700, -5799, -5898, -5997, -6096, -6195, -6293, -6392, -6491,
		-6589, -6688, -6786, -6884, -6982, -7081, -7179, -7277, -7375, -7473,
		-7571, -7668, -7766, -7864, -7961, -8059, -8156, -8253, -8351, -8448,
		-8545, -8642, -8739, -8836, -8932, -9029, -9126, -9222, -9319, -9415,
		-9511, -9607, -9703, -9799, -9895, -9991, -10087, -10182, -10278, -10373,
		-10469, -10564, -10659, -10754, -10849, -10944, -11038, -11133, -11227, -11322,
		-11416, -11510, -11604, -11698, -11792, -11886, -11980, -12073, -12166, -12260,
		-12353, -12446, -12539, -12632, -12724, -12817, -12909, -13002, -13094, -13186,
		-13278, -13370, -13462, -13553, -13645, -13736, -13827, -13918, -14009, -14100,
		-14191, -14281, -14372, -14462, -14552, -14642, -14732, -14822, -14911, -15001,
		-15090, -15179, -15268, -15357, -15446, -15534, -15623, -15711, -15799, -15887,
		-15975, -16063, -16150, -16238, -16325, -16412, -16499, -16586, -16672, -16759,
		-16845, -16931, -17017, -17103, -17189, -17274, -17360, -17445, -17530, -17615,
		-17699, -17784, -17868, -17952, -18036, -18120, -18204, -18287, -18371, -18454,
		-18537, -18620, -18702, -18785, -18867, -18949, -19031, -19113, -19194, -19276,
		-19357, -19438, -19519, -19599, -19680, -19760, -19840, -19920, -20000, -20079,
		-20159, -20238, -20317, -20396, -20474, -20553, -20631, -20709, -20787, -20864,
		-20942, -21019, -21096, -21173, -21249, -21326, -21402, -21478, -21554, -21629,
		-21705, -21780, -21855, -21930, -22004, -22079, -22153, -22227, -22301, -22374,
		-22448, -22521, -22594, -22666, -22739, -22811, -22883, -22955, -23027, -23098,
		-23169, -23240, -23311, -23382, -23452, -23522, -23592, -23661, -23731, -23800,
		-23869, -23938, -24006, -24075, -24143, -24211, -24278, -24346, -24413, -24480,
		-24546, -24613, -24679, -24745, -24811, -24877, -24942, -25007, -25072, -25136,
		-25201, -25265, -25329, -25392, -25456, -25519, -25582, -25645, -25707, -25769,
		-25831, -25893, -25954, -26016, -26077, -26137, -26198, -26258, -26318, -26378,
		-26437, -26497, -26556, -26615, -26673, -26731, -26789, -26847, -26905, -26962,
		-27019, -27076, -27132, -27188, -27244, -27300, -27355, -27411, -27466, -27520,
		-27575, -27629, -27683, -27736, -27790, -27843, -27896, -27948, -28001, -28053,
		-28105, -28156, -28208, -28259, -28309, -28360, -28410, -28460, -28510, -28559,
		-28608, -28657, -28706, -28754, -28802, -28850, -28897, -28945, -28992, -29038,
		-29085, -29131, -29177, -29222, -29268, -29313, -29358, -29402, -29446, -29490,
		-29534, -29577, -29621, -29663, -29706, -29748, -29790, -29832, -29873, -29915,
		-29955, -29996, -30036, -30076, -30116, -30156, -30195, -30234, -30272, -30311,
		-30349, -30386, -30424, -30461, -30498, -30535, -30571, -30607, -30643, -30678,
		-30713, -30748, -30783, -30817, -30851, -30885, -30918, -30951, -30984, -31017,
		-31049, -31081, -31113, -31144, -31175, -31206, -31236, -31267, -31297, -31326,
		-31356, -31385, -31413, -31442, -31470, -31498, -31525, -31553, -31580, -31606,
		-31633, -31659, -31684, -31710, -31735, -31760, -31785, -31809, -31833, -31856,
		-31880, -31903, -31926, -31948, -31970, -31992, -32014, -32035, -32056, -32077,
		-32097, -32117, -32137, -32156, -32176, -32194, -32213, -32231, -32249, -32267,
		-32284, -32301, -32318, -32334, -32350, -32366, -32382, -32397, -32412, -32426,
		-32441, -32455, -32468, -32482, -32495, -32508, -32520, -32532, -32544, -32556,
		-32567, -32578, -32588, -32599, -32609, -32618, -32628, -32637, -32646, -32654,
		-32662, -32670, -32678, -32685, -32692, -32699, -32705, -32711, -32717, -32722,
		-32727, -32732, -32736, -32740, -32744, -32748, -32751, -32754, -32757, -32759,
		-32761, -32763, -32764, -32765, -32766, -32766, -32767, -32766, -32766, -32765,
		-32764, -32763, -32761, -32759, -32757, -32754, -32751, -32748, -32744, -32740,
		-32736, -32732, -32727, -32722, -32717, -32711, -32705, -32699, -32692, -32685,
		-32678, -32670, -32662, -32654, -32646, -32637, -32628, -32618, -32609, -32599,
		-32588, -32578, -32567, -32556, -32544, -32532, -32520, -32508, -32495, -32482,
		-32468, -32455, -32441, -32426, -32412, -32397, -32382, -32366, -32350, -32334,
		-32318, -32301, -32284, -32267, -32249, -32231, -32213, -32194, -32176, -32156,
		-32137, -32117, -32097, -32077, -32056, -32035, -32014, -31992, -31970, -31948,
		-31926, -31903, -31880, -31856, -31833, -31809, -31785, -31760, -31735, -31710,
		-31684, -31659, -31633, -31606, -31580, -31553, -31525, -31498, -31470, -31442,
		-31413, -31385, -31356, -31326, -31297, -31267, -31236, -31206, -31175, -31144,
		-31113, -31081, -31049, -31017, -30984, -30951, -30918, -30885, -30851, -30817,
		-30783, -30748, -30713, -30678, -30643, -30607, -30571, -30535, -30498, -30461,
		-30424, -30386, -30349, -30311, -30272, -30234, -30195, -30156, -30116, -30076,
		-30036, -29996, -29955, -29915, -29873, -29832, -29790, -29748, -29706, -29663,
		-29621, -29577, -29534, -29490, -29446, -29402, -29358, -29313, -29268, -29222,
		-29177, -29131, -29085, -29038, -28992, -28945, -28897, -28850, -28802, -28754,
		-28706, -28657, -28608, -28559, -28510, -28460, -28410, -28360, -28309, -28259,
		-28208, -28156, -28105, -28053, -28001, -27948, -27896, -27843, -27790, -27736,
		-27683, -27629, -27575, -27520, -27466, -27411, -27355, -27300, -27244, -27188,
		-27132, -27076, -27019, -26962, -26905, -26847, -26789, -26731, -26673, -26615,
		-26556, -26497, -26437, -26378, -26318, -26258, -26198, -26137, -26077, -26016,
		-25954, -25893, -25831, -25769, -25707, -25645, -25582, -25519, -25456, -25392,
		-25329, -25265, -25201, -25136, -25072, -25007, -24942, -24877, -24811, -24745,
		-24679, -24613, -24546, -24480, -24413, -24346, -24278, -24211, -24143, -24075,
		-24006, -23938, -23869, -23800, -23731, -23661, -23592, -23522, -23452, -23382,
		-23311, -23240, -23169, -23098, -23027, -22955, -22883, -22811, -22739, -22666,
		-22594, -22521, -22448, -22374, -22301, -22227, -22153, -22079, -22004, -21930,
		-21855, -21780, -21705, -21629, -21554, -21478, -21402, -21326, -21249, -21173,
		-21096, -21019, -20942, -20864, -20787, -20709, -20631, -20553, -20474, -20396,
		-20317, -20238, -20159, -20079, -20000, -19920, -19840, -19760, -19680, -19599,
		-19519, -19438, -19357, -19276, -19194, -19113, -19031, -18949, -18867, -18785,
		-18702, -18620, -18537, -18454, -18371, -18287, -18204, -18120, -18036, -17952,
		-17868, -17784, -17699, -17615, -17530, -17445, -17360, -17274, -17189, -17103,
		-17017, -16931, -16845, -16759, -16672, -16586, -16499, -16412, -16325, -16238,
		-16150, -16063, -15975, -15887, -15799, -15711, -15623, -15534, -15446, -15357,
		-15268, -15179, -15090, -15001, -14911, -14822, -14732, -14642, -14552, -14462,
		-14372, -14281, -14191, -14100, -14009, -13918, -13827, -13736, -13645, -13553,
		-13462, -13370, -13278, -13186, -13094, -13002, -12909, -12817, -12724, -12632,
		-12539, -12446, -12353, -12260, -12166, -12073, -11980, -11886, -11792, -11698,
		-11604, -11510, -11416, -11322, -11227, -11133, -11038, -10944, -10849, -10754,
		-10659, -10564, -10469, -10373, -10278, -10182, -10087, -9991, -9895, -9799,
		-9703, -9607, -9511, -9415, -9319, -9222, -9126, -9029, -8932, -8836,
		-8739, -8642, -8545, -8448, -8351, -8253, -8156, -8059, -7961, -7864,
		-7766, -7668, -7571, -7473, -7375, -7277, -7179, -7081, -6982, -6884,
		-6786, -6688, -6589, -6491, -6392, -6293, -6195, -6096, -5997, -5898,
		-5799, -5700, -5601, -5502, -5403, -5304, -5205, -5106, -5006, -4907,
		-4807, -4708, -4608, -4509, -4409, -4310, -4210, -4110, -4011, -3911,
		-3811, -3711, -3611, -3511, -3411, -3311, -3211, -3111, -3011, -2911,
		-2811, -2711, -2610, -2510, -2410, -2310, -2209, -2109, -2009, -1908,
		-1808, -1708, -1607, -1507, -1406, -1306, -1206, -1105, -1005, -904,
		-804, -703, -603, -502, -402, -301, -201, -100 ,

		 // bandlimited square : order 16 - 1024 steps
		-1    , 1733  , 3462  , 5180  , 6881  , 8560  , 10212 , 11832 , 13415 , 14956 ,
		16451 , 17896 , 19286 , 20618 , 21890 , 23097 , 24237 , 25309 , 26310 , 27239 ,
		28094 , 28875 , 29583 , 30216 , 30775 , 31261 , 31676 , 32020 , 32296 , 32507 ,
		32653 , 32739 , 32766 , 32740 , 32662 , 32537 , 32368 , 32159 , 31915 , 31639 ,
		31336 , 31009 , 30664 , 30303 , 29932 , 29553 , 29171 , 28790 , 28414 , 28044 ,
		27686 , 27341 , 27013 , 26703 , 26415 , 26149 , 25909 , 25694 , 25507 , 25349 ,
		25219 , 25118 , 25047 , 25004 , 24990 , 25004 , 25045 , 25111 , 25202 , 25315 ,
		25450 , 25604 , 25775 , 25962 , 26162 , 26372 , 26592 , 26817 , 27047 , 27278 ,
		27509 , 27738 , 27961 , 28178 , 28386 , 28584 , 28770 , 28942 , 29099 , 29240 ,
		29364 , 29469 , 29556 , 29624 , 29673 , 29702 , 29712 , 29702 , 29674 , 29627 ,
		29564 , 29484 , 29388 , 29278 , 29156 , 29021 , 28877 , 28724 , 28564 , 28399 ,
		28230 , 28059 , 27888 , 27718 , 27551 , 27388 , 27231 , 27081 , 26941 , 26810 ,
		26690 , 26582 , 26486 , 26405 , 26337 , 26284 , 26247 , 26224 , 26216 , 26224 ,
		26246 , 26283 , 26333 , 26397 , 26473 , 26561 , 26660 , 26768 , 26884 , 27008 ,
		27138 , 27272 , 27410 , 27550 , 27690 , 27830 , 27968 , 28102 , 28232 , 28356 ,
		28473 , 28582 , 28683 , 28773 , 28853 , 28921 , 28978 , 29023 , 29055 , 29074 ,
		29080 , 29074 , 29055 , 29024 , 28980 , 28926 , 28860 , 28784 , 28699 , 28606 ,
		28505 , 28398 , 28285 , 28168 , 28047 , 27925 , 27802 , 27680 , 27559 , 27440 ,
		27326 , 27216 , 27113 , 27016 , 26927 , 26847 , 26775 , 26714 , 26663 , 26624 ,
		26595 , 26578 , 26572 , 26578 , 26595 , 26623 , 26662 , 26712 , 26771 , 26840 ,
		26918 , 27003 , 27095 , 27193 , 27297 , 27404 , 27514 , 27627 , 27740 , 27853 ,
		27965 , 28074 , 28180 , 28282 , 28378 , 28468 , 28551 , 28626 , 28692 , 28749 ,
		28797 , 28834 , 28861 , 28878 , 28883 , 28878 , 28861 , 28835 , 28798 , 28751 ,
		28694 , 28629 , 28555 , 28474 , 28386 , 28292 , 28193 , 28091 , 27985 , 27877 ,
		27768 , 27659 , 27552 , 27446 , 27344 , 27246 , 27152 , 27065 , 26985 , 26912 ,
		26847 , 26791 , 26745 , 26709 , 26682 , 26666 , 26661 , 26666 , 26682 , 26709 ,
		26745 , 26791 , 26847 , 26912 , 26985 , 27065 , 27152 , 27246 , 27344 , 27446 ,
		27552 , 27659 , 27768 , 27877 , 27985 , 28091 , 28193 , 28292 , 28386 , 28474 ,
		28555 , 28629 , 28694 , 28751 , 28798 , 28835 , 28861 , 28878 , 28883 , 28878 ,
		28861 , 28834 , 28797 , 28749 , 28692 , 28626 , 28551 , 28468 , 28378 , 28282 ,
		28180 , 28074 , 27965 , 27853 , 27740 , 27627 , 27514 , 27404 , 27297 , 27193 ,
		27095 , 27003 , 26918 , 26840 , 26771 , 26712 , 26662 , 26623 , 26595 , 26578 ,
		26572 , 26578 , 26595 , 26624 , 26663 , 26714 , 26775 , 26847 , 26927 , 27016 ,
		27113 , 27216 , 27326 , 27440 , 27559 , 27680 , 27802 , 27925 , 28047 , 28168 ,
		28285 , 28398 , 28505 , 28606 , 28699 , 28784 , 28860 , 28926 , 28980 , 29024 ,
		29055 , 29074 , 29080 , 29074 , 29055 , 29023 , 28978 , 28921 , 28853 , 28773 ,
		28683 , 28582 , 28473 , 28356 , 28232 , 28102 , 27968 , 27830 , 27690 , 27550 ,
		27410 , 27272 , 27138 , 27008 , 26884 , 26768 , 26660 , 26561 , 26473 , 26397 ,
		26333 , 26283 , 26246 , 26224 , 26216 , 26224 , 26247 , 26284 , 26337 , 26405 ,
		26486 , 26582 , 26690 , 26810 , 26941 , 27081 , 27231 , 27388 , 27551 , 27718 ,
		27888 , 28059 , 28230 , 28399 , 28564 , 28724 , 28877 , 29021 , 29156 , 29278 ,
		29388 , 29484 , 29564 , 29627 , 29674 , 29702 , 29712 , 29702 , 29673 , 29624 ,
		29556 , 29469 , 29364 , 29240 , 29099 , 28942 , 28770 , 28584 , 28386 , 28178 ,
		27961 , 27738 , 27509 , 27278 , 27047 , 26817 , 26592 , 26372 , 26162 , 25962 ,
		25775 , 25604 , 25450 , 25315 , 25202 , 25111 , 25045 , 25004 , 24990 , 25004 ,
		25047 , 25118 , 25219 , 25349 , 25507 , 25694 , 25909 , 26149 , 26415 , 26703 ,
		27013 , 27341 , 27686 , 28044 , 28414 , 28790 , 29171 , 29553 , 29932 , 30303 ,
		30664 , 31009 , 31336 , 31639 , 31915 , 32159 , 32368 , 32537 , 32662 , 32740 ,
		32767 , 32739 , 32653 , 32507 , 32296 , 32020 , 31676 , 31261 , 30775 , 30216 ,
		29583 , 28875 , 28094 , 27239 , 26310 , 25309 , 24237 , 23097 , 21890 , 20618 ,
		19286 , 17896 , 16451 , 14956 , 13415 , 11832 , 10212 , 8560  , 6881  , 5180  ,
		3462  , 1733  , -1    , -1735 , -3464 , -5182 , -6883 , -8562 , -10214, -11834,
		-13417, -14958, -16453, -17898, -19288, -20620, -21892, -23099, -24239, -25311,
		-26312, -27241, -28096, -28877, -29585, -30218, -30777, -31263, -31678, -32022,
		-32298, -32509, -32655, -32741, -32768, -32742, -32664, -32539, -32370, -32161,
		-31917, -31641, -31338, -31011, -30666, -30305, -29934, -29555, -29173, -28792,
		-28416, -28046, -27688, -27343, -27015, -26705, -26417, -26151, -25911, -25696,
		-25509, -25351, -25221, -25120, -25049, -25006, -24992, -25006, -25047, -25113,
		-25204, -25317, -25452, -25606, -25777, -25964, -26164, -26374, -26594, -26819,
		-27049, -27280, -27511, -27740, -27963, -28180, -28388, -28586, -28772, -28944,
		-29101, -29242, -29366, -29471, -29558, -29626, -29675, -29704, -29714, -29704,
		-29676, -29629, -29566, -29486, -29390, -29280, -29158, -29023, -28879, -28726,
		-28566, -28401, -28232, -28061, -27890, -27720, -27553, -27390, -27233, -27083,
		-26943, -26812, -26692, -26584, -26488, -26407, -26339, -26286, -26249, -26226,
		-26218, -26226, -26248, -26285, -26335, -26399, -26475, -26563, -26662, -26770,
		-26886, -27010, -27140, -27274, -27412, -27552, -27692, -27832, -27970, -28104,
		-28234, -28358, -28475, -28584, -28685, -28775, -28855, -28923, -28980, -29025,
		-29057, -29076, -29082, -29076, -29057, -29026, -28982, -28928, -28862, -28786,
		-28701, -28608, -28507, -28400, -28287, -28170, -28049, -27927, -27804, -27682,
		-27561, -27442, -27328, -27218, -27115, -27018, -26929, -26849, -26777, -26716,
		-26665, -26626, -26597, -26580, -26574, -26580, -26597, -26625, -26664, -26714,
		-26773, -26842, -26920, -27005, -27097, -27195, -27299, -27406, -27516, -27629,
		-27742, -27855, -27967, -28076, -28182, -28284, -28380, -28470, -28553, -28628,
		-28694, -28751, -28799, -28836, -28863, -28880, -28885, -28880, -28863, -28837,
		-28800, -28753, -28696, -28631, -28557, -28476, -28388, -28294, -28195, -28093,
		-27987, -27879, -27770, -27661, -27554, -27448, -27346, -27248, -27154, -27067,
		-26987, -26914, -26849, -26793, -26747, -26711, -26684, -26668, -26663, -26668,
		-26684, -26711, -26747, -26793, -26849, -26914, -26987, -27067, -27154, -27248,
		-27346, -27448, -27554, -27661, -27770, -27879, -27987, -28093, -28195, -28294,
		-28388, -28476, -28557, -28631, -28696, -28753, -28800, -28837, -28863, -28880,
		-28885, -28880, -28863, -28836, -28799, -28751, -28694, -28628, -28553, -28470,
		-28380, -28284, -28182, -28076, -27967, -27855, -27742, -27629, -27516, -27406,
		-27299, -27195, -27097, -27005, -26920, -26842, -26773, -26714, -26664, -26625,
		-26597, -26580, -26574, -26580, -26597, -26626, -26665, -26716, -26777, -26849,
		-26929, -27018, -27115, -27218, -27328, -27442, -27561, -27682, -27804, -27927,
		-28049, -28170, -28287, -28400, -28507, -28608, -28701, -28786, -28862, -28928,
		-28982, -29026, -29057, -29076, -29082, -29076, -29057, -29025, -28980, -28923,
		-28855, -28775, -28685, -28584, -28475, -28358, -28234, -28104, -27970, -27832,
		-27692, -27552, -27412, -27274, -27140, -27010, -26886, -26770, -26662, -26563,
		-26475, -26399, -26335, -26285, -26248, -26226, -26218, -26226, -26249, -26286,
		-26339, -26407, -26488, -26584, -26692, -26812, -26943, -27083, -27233, -27390,
		-27553, -27720, -27890, -28061, -28232, -28401, -28566, -28726, -28879, -29023,
		-29158, -29280, -29390, -29486, -29566, -29629, -29676, -29704, -29714, -29704,
		-29675, -29626, -29558, -29471, -29366, -29242, -29101, -28944, -28772, -28586,
		-28388, -28180, -27963, -27740, -27511, -27280, -27049, -26819, -26594, -26374,
		-26164, -25964, -25777, -25606, -25452, -25317, -25204, -25113, -25047, -25006,
		-24992, -25006, -25049, -25120, -25221, -25351, -25509, -25696, -25911, -26151,
		-26417, -26705, -27015, -27343, -27688, -28046, -28416, -28792, -29173, -29555,
		-29934, -30305, -30666, -31011, -31338, -31641, -31917, -32161, -32370, -32539,
		-32664, -32742, -32768, -32741, -32655, -32509, -32298, -32022, -31678, -31263,
		-30777, -30218, -29585, -28877, -28096, -27241, -26312, -25311, -24239, -23099,
		-21892, -20620, -19288, -17898, -16453, -14958, -13417, -11834, -10214, -8562 ,
		-6883 , -5182 , -3464 , -1735,
		 // Min =  -32768
		 // Max =  32767

		 // bandlimited saw : order 16 / 1024 steps
		-1    , -1829 , -3651 , -5460 , -7250 , -9014 , -10747, -12443, -14096, -15701,
		-17253, -18746, -20177, -21542, -22837, -24058, -25203, -26270, -27257, -28162,
		-28984, -29723, -30379, -30952, -31443, -31853, -32184, -32439, -32619, -32728,
		-32768, -32744, -32659, -32517, -32322, -32079, -31792, -31466, -31106, -30716,
		-30301, -29867, -29417, -28957, -28491, -28023, -27557, -27098, -26649, -26214,
		-25796, -25398, -25022, -24671, -24348, -24053, -23788, -23553, -23351, -23181,
		-23043, -22937, -22863, -22819, -22805, -22818, -22859, -22924, -23013, -23122,
		-23249, -23393, -23550, -23718, -23895, -24078, -24264, -24451, -24637, -24818,
		-24993, -25160, -25315, -25459, -25588, -25701, -25797, -25875, -25933, -25971,
		-25989, -25986, -25962, -25917, -25851, -25766, -25661, -25538, -25397, -25240,
		-25068, -24882, -24685, -24477, -24261, -24038, -23810, -23578, -23346, -23114,
		-22884, -22658, -22438, -22225, -22020, -21826, -21643, -21472, -21314, -21170,
		-21041, -20927, -20829, -20746, -20679, -20628, -20592, -20571, -20564, -20571,
		-20590, -20621, -20663, -20714, -20773, -20840, -20912, -20988, -21067, -21148,
		-21228, -21308, -21384, -21456, -21523, -21583, -21636, -21679, -21714, -21737,
		-21750, -21751, -21740, -21717, -21680, -21631, -21570, -21496, -21410, -21312,
		-21203, -21084, -20954, -20816, -20670, -20517, -20358, -20194, -20027, -19857,
		-19686, -19514, -19343, -19175, -19010, -18849, -18694, -18544, -18402, -18268,
		-18143, -18026, -17920, -17823, -17737, -17662, -17598, -17544, -17501, -17468,
		-17445, -17432, -17427, -17432, -17443, -17462, -17487, -17517, -17551, -17589,
		-17628, -17670, -17711, -17752, -17791, -17827, -17860, -17888, -17911, -17927,
		-17937, -17940, -17934, -17920, -17898, -17866, -17825, -17774, -17714, -17645,
		-17567, -17480, -17385, -17281, -17170, -17053, -16929, -16800, -16666, -16528,
		-16387, -16244, -16100, -15956, -15812, -15669, -15529, -15392, -15259, -15131,
		-15007, -14890, -14780, -14676, -14580, -14492, -14412, -14340, -14277, -14222,
		-14175, -14137, -14106, -14083, -14067, -14058, -14055, -14058, -14065, -14077,
		-14093, -14111, -14131, -14153, -14175, -14196, -14216, -14234, -14250, -14262,
		-14269, -14272, -14270, -14261, -14247, -14225, -14196, -14160, -14117, -14065,
		-14006, -13940, -13866, -13785, -13697, -13602, -13501, -13394, -13282, -13166,
		-13045, -12921, -12795, -12667, -12537, -12407, -12278, -12149, -12023, -11898,
		-11777, -11660, -11547, -11439, -11337, -11240, -11150, -11066, -10989, -10919,
		-10857, -10801, -10752, -10710, -10675, -10647, -10625, -10608, -10597, -10591,
		-10589, -10590, -10595, -10603, -10612, -10622, -10633, -10643, -10653, -10661,
		-10667, -10669, -10668, -10664, -10654, -10640, -10620, -10594, -10562, -10523,
		-10478, -10427, -10368, -10303, -10232, -10154, -10070, -9980 , -9885 , -9785 ,
		-9680 , -9570 , -9458 , -9342 , -9224 , -9104 , -8983 , -8862 , -8740 , -8620 ,
		-8501 , -8384 , -8270 , -8160 , -8053 , -7950 , -7852 , -7760 , -7673 , -7591 ,
		-7516 , -7447 , -7384 , -7328 , -7278 , -7235 , -7197 , -7165 , -7139 , -7118 ,
		-7102 , -7090 , -7083 , -7079 , -7077 , -7078 , -7081 , -7085 , -7089 , -7094 ,
		-7097 , -7099 , -7099 , -7097 , -7091 , -7082 , -7068 , -7050 , -7027 , -6999 ,
		-6965 , -6926 , -6880 , -6828 , -6770 , -6707 , -6637 , -6561 , -6479 , -6392 ,
		-6300 , -6204 , -6103 , -5998 , -5890 , -5778 , -5665 , -5550 , -5434 , -5317 ,
		-5200 , -5085 , -4970 , -4857 , -4747 , -4640 , -4536 , -4437 , -4341 , -4251 ,
		-4166 , -4086 , -4011 , -3943 , -3880 , -3823 , -3772 , -3728 , -3688 , -3655 ,
		-3626 , -3603 , -3584 , -3570 , -3559 , -3552 , -3547 , -3545 , -3544 , -3544 ,
		-3545 , -3546 , -3547 , -3546 , -3543 , -3538 , -3529 , -3518 , -3503 , -3483 ,
		-3458 , -3429 , -3395 , -3354 , -3309 , -3257 , -3200 , -3136 , -3067 , -2993 ,
		-2913 , -2827 , -2737 , -2642 , -2543 , -2440 , -2334 , -2225 , -2114 , -2001 ,
		-1887 , -1773 , -1659 , -1545 , -1432 , -1321 , -1213 , -1107 , -1004 , -906  ,
		-811  , -722  , -637  , -557  , -483  , -414  , -352  , -294  , -243  , -198  ,
		-158  , -123  , -94   , -69   , -49   , -34   , -22   , -13   , -7    , -4    ,
		-2    , -1    , -1    , -1    , 0     , 2     , 5     , 11    , 20    , 32    ,
		47    , 67    , 92    , 121   , 156   , 196   , 241   , 292   , 350   , 412   ,
		481   , 555   , 635   , 720   , 809   , 904   , 1002  , 1105  , 1211  , 1319  ,
		1430  , 1543  , 1657  , 1771  , 1885  , 1999  , 2112  , 2223  , 2332  , 2438  ,
		2541  , 2640  , 2735  , 2825  , 2911  , 2991  , 3065  , 3134  , 3198  , 3255  ,
		3307  , 3352  , 3393  , 3427  , 3456  , 3481  , 3501  , 3516  , 3527  , 3536  ,
		3541  , 3544  , 3545  , 3544  , 3543  , 3542  , 3542  , 3543  , 3545  , 3550  ,
		3557  , 3568  , 3582  , 3601  , 3624  , 3653  , 3686  , 3726  , 3770  , 3821  ,
		3878  , 3941  , 4009  , 4084  , 4164  , 4249  , 4339  , 4435  , 4534  , 4638  ,
		4745  , 4855  , 4968  , 5083  , 5198  , 5315  , 5432  , 5548  , 5663  , 5776  ,
		5888  , 5996  , 6101  , 6202  , 6298  , 6390  , 6477  , 6559  , 6635  , 6705  ,
		6768  , 6826  , 6878  , 6924  , 6963  , 6997  , 7025  , 7048  , 7066  , 7080  ,
		7089  , 7095  , 7097  , 7097  , 7095  , 7092  , 7087  , 7083  , 7079  , 7076  ,
		7075  , 7077  , 7081  , 7088  , 7100  , 7116  , 7137  , 7163  , 7195  , 7233  ,
		7276  , 7326  , 7382  , 7445  , 7514  , 7589  , 7671  , 7758  , 7850  , 7948  ,
		8051  , 8158  , 8268  , 8382  , 8499  , 8618  , 8738  , 8860  , 8981  , 9102  ,
		9222  , 9340  , 9456  , 9568  , 9678  , 9783  , 9883  , 9978  , 10068 , 10152 ,
		10230 , 10301 , 10366 , 10425 , 10476 , 10521 , 10560 , 10592 , 10618 , 10638 ,
		10652 , 10662 , 10666 , 10667 , 10665 , 10659 , 10651 , 10641 , 10631 , 10620 ,
		10610 , 10601 , 10593 , 10588 , 10587 , 10589 , 10595 , 10606 , 10623 , 10645 ,
		10673 , 10708 , 10750 , 10799 , 10855 , 10917 , 10987 , 11064 , 11148 , 11238 ,
		11335 , 11437 , 11545 , 11658 , 11775 , 11896 , 12021 , 12147 , 12276 , 12405 ,
		12535 , 12665 , 12793 , 12919 , 13043 , 13164 , 13280 , 13392 , 13499 , 13600 ,
		13695 , 13783 , 13864 , 13938 , 14004 , 14063 , 14115 , 14158 , 14194 , 14223 ,
		14245 , 14259 , 14268 , 14270 , 14267 , 14260 , 14248 , 14232 , 14214 , 14194 ,
		14173 , 14151 , 14129 , 14109 , 14091 , 14075 , 14063 , 14056 , 14053 , 14056 ,
		14065 , 14081 , 14104 , 14135 , 14173 , 14220 , 14275 , 14338 , 14410 , 14490 ,
		14578 , 14674 , 14778 , 14888 , 15005 , 15129 , 15257 , 15390 , 15527 , 15667 ,
		15810 , 15954 , 16098 , 16242 , 16385 , 16526 , 16664 , 16798 , 16927 , 17051 ,
		17168 , 17279 , 17383 , 17478 , 17565 , 17643 , 17712 , 17772 , 17823 , 17864 ,
		17896 , 17918 , 17932 , 17938 , 17935 , 17925 , 17909 , 17886 , 17858 , 17825 ,
		17789 , 17750 , 17709 , 17668 , 17626 , 17587 , 17549 , 17515 , 17485 , 17460 ,
		17441 , 17430 , 17425 , 17430 , 17443 , 17466 , 17499 , 17542 , 17596 , 17660 ,
		17735 , 17821 , 17918 , 18024 , 18141 , 18266 , 18400 , 18542 , 18692 , 18847 ,
		19008 , 19173 , 19341 , 19512 , 19684 , 19855 , 20025 , 20192 , 20356 , 20515 ,
		20668 , 20814 , 20952 , 21082 , 21201 , 21310 , 21408 , 21494 , 21568 , 21629 ,
		21678 , 21715 , 21738 , 21749 , 21748 , 21735 , 21712 , 21677 , 21634 , 21581 ,
		21521 , 21454 , 21382 , 21306 , 21226 , 21146 , 21065 , 20986 , 20910 , 20838 ,
		20771 , 20712 , 20661 , 20619 , 20588 , 20569 , 20562 , 20569 , 20590 , 20626 ,
		20677 , 20744 , 20827 , 20925 , 21039 , 21168 , 21312 , 21470 , 21641 , 21824 ,
		22018 , 22223 , 22436 , 22656 , 22882 , 23112 , 23344 , 23576 , 23808 , 24036 ,
		24259 , 24475 , 24683 , 24880 , 25066 , 25238 , 25395 , 25536 , 25659 , 25764 ,
		25849 , 25915 , 25960 , 25984 , 25987 , 25969 , 25931 , 25873 , 25795 , 25699 ,
		25586 , 25457 , 25313 , 25158 , 24991 , 24816 , 24635 , 24449 , 24262 , 24076 ,
		23893 , 23716 , 23548 , 23391 , 23247 , 23120 , 23011 , 22922 , 22857 , 22816 ,
		22803 , 22817 , 22861 , 22935 , 23041 , 23179 , 23349 , 23551 , 23786 , 24051 ,
		24346 , 24669 , 25020 , 25396 , 25794 , 26212 , 26647 , 27096 , 27555 , 28021 ,
		28489 , 28955 , 29415 , 29865 , 30299 , 30714 , 31104 , 31464 , 31790 , 32077 ,
		32320 , 32515 , 32657 , 32742 , 32767 , 32726 , 32617 , 32437 , 32182 , 31851 ,
		31441 , 30950 , 30377 , 29721 , 28982 , 28160 , 27255 , 26268 , 25201 , 24056 ,
		22835 , 21540 , 20175 , 18744 , 17251 , 15699 , 14094 , 12441 , 10745 , 9012  ,
		7248  , 5458  , 3649  , 1827,
		 // Min =  -32768
		 // Max =  32767

};

const int frequenciesX8[]  = { 65,
// 1...
69, 73, 77, 82, 87, 92, 98, 103, 110, 116,
123, 130, 138, 146, 155, 164, 174, 184, 196, 207,
220, 233, 246, 261, 277, 293, 311, 329, 349, 370,
392, 415, 440, 466, 493, 523, 554, 587, 622, 659,
698, 740, 784, 830, 880, 932, 987, 1046, 1108, 1174,
1244, 1318, 1396, 1480, 1568, 1661, 1760, 1864, 1975, 2093,
2217, 2349, 2489, 2637, 2793, 2959, 3136, 3322, 3520, 3729,
3951, 4186, 4434, 4698, 4978, 5274, 5587, 5919, 6271, 6644,
7040, 7458, 7902, 8372, 8869, 9397, 9956, 10548, 11175, 11839,
12543, 13289, 14080, 14917, 15804, 16744, 17739, 18794, 19912, 21096,
22350, 23679, 25087, 26579, 28160, 29834, 31608, 33488, 35479, 37589,
39824, 42192, 44701, 47359, 50175, 53159, 56320, 59668, 63217, 66976,
70958, 75178, 79648, 84384, 89402, 94718 };




